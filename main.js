!function(){"use strict";var e=class{constructor(e){let{data:t,cardSelector:s,handleCardClick:r}=e;this._title=t.title,this._link=t.link,this._cardSelector=s,this._handleCardClick=r}_getTemplate(){return this._cardSelector.cloneNode(!0).querySelector(".card")}_handleLikeButton=()=>{this._likeBtn.classList.toggle("card__like-button_active")};_handleDeleteButton=()=>{this._cardElement.remove(),this._cardElement=null};_setEventListeners(){this._cardImage.addEventListener("click",this._handleCardClick),this._likeBtn.addEventListener("click",this._handleLikeButton),this._deleteBtn.addEventListener("click",this._handleDeleteButton)}getView(){return this._cardElement=this._getTemplate(),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardImage=this._cardElement.querySelector(".card__image"),this._likeBtn=this._cardElement.querySelector(".card__like-button"),this._deleteBtn=this._cardElement.querySelector(".card__delete-button"),this._cardTitle.textContent=this._title,this._cardImage.alt=this._title,this._cardImage.src=this._link,this._setEventListeners(),this._cardElement}},t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleButtonState(),this.checkInputValidity(e)}))}))}enableValidation(){this._setEventListeners()}},s=class{constructor(e){let{popup:t}=e;this._popup=t}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleCloseByEsc)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleCloseByEsc)}_handleCloseByEsc=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close-button"))&&this.close()}))}},r=class extends s{constructor(e,t){let{popup:s,handleFormSubmit:r}=e;super({popup:s}),this._popupForm=this._popup,this._handleFormSubmit=r,this._inputSelector=t.inputSelector,this._inputList=[...this._popupForm.querySelectorAll(this._inputSelector)]}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),e.target.reset()}))}};const i={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"},n=new class{constructor(e){this.baseUrl=e.baseUrl,this.headers=e.headers}getUserInformation(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editProfileData(e){return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.job})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:e.title,link:e.link})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateProfileImage(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9fbfab1b-69d6-43a9-b085-60d57b074309","Content-Type":"application/json"}}),o=document.querySelector(".profile__title"),a=document.querySelector(".profile__description"),l=document.querySelector(".profile__image"),c=document.querySelector(".gallery__cards"),u=document.querySelector("#card-template").content,d=document.getElementById("edit-modal"),h=document.getElementById("new-card-modal"),m=document.getElementById("avatar-edit-modal"),p=document.getElementById("preview-image-modal"),_=p.querySelector(".preview-image"),E=p.querySelector(".image-description"),g=document.querySelector(".profile__edit-button"),b=document.querySelector(".profile__plus-button"),v=document.querySelector(".edit__avatar-button"),f={},S=t=>{const s=(t=>new e({data:t,cardSelector:u,handleCardClick:()=>{y.open(t)}}).getView())(t);k.setItem(s)},L=new class{constructor(e){let{userName:t,userJob:s}=e;this._userName=t,this._userJob=s}getUserInfo(){const e={};return e.name=this._userName.textContent,e.job=this._userJob.textContent,e}setUserInfo(e){this._userName.textContent=e.name,this._userJob.textContent=e.job}}({userName:o,userJob:a}),k=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}setItem(e){this._container.prepend(e)}}({items:[{title:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{title:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{title:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{title:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{title:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{title:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:S},c),y=new class extends s{constructor(e,t){let{popupImage:s,popupImageText:r}=e;super({popup:t}),this._popup=t,this._popupImage=s,this._popupImageText=r}open(e){super.open(),this._popupImage.src=e.link,this._popupImage.alt=e.title,this._popupImageText.textContent=e.title}}({popupImage:_,popupImageText:E},p),I=new r({popup:d,handleFormSubmit:e=>{L.setUserInfo(e),n.editProfileData(e),I.close()}},i),C=new r({popup:h,handleFormSubmit:e=>{S(e),n.addNewCard(e),C.close()}},i),w=new r({popup:m,handleFormSubmit:e=>{l.src=e,n.updateProfileImage(e),w.close()}},i);g.addEventListener("click",(()=>{const e=L.getUserInfo();I.setInputValues(e),f["edit-form"].resetValidation(),I.open()})),b.addEventListener("click",(()=>{f["new-card-form"].resetValidation(),C.open()})),v.addEventListener("click",(()=>{f["avatar-edit-form"].resetValidation(),w.open()})),y.setEventListeners(),I.setEventListeners(),C.setEventListeners(),w.setEventListeners(),(e=>{[...document.querySelectorAll(e.formSelector)].forEach((s=>{const r=new t(e,s),i=s.getAttribute("name");f[i]=r,r.enableValidation()}))})(i),k.renderItems()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBbURBLE1BbkRBLE1BQ0VBLFdBQUFBLENBQVdDLEdBQTBDLElBQXpDLEtBQUVDLEVBQUksYUFBRUMsRUFBWSxnQkFBRUMsR0FBaUJILEVBQ2pESSxLQUFLQyxPQUFTSixFQUFLSyxNQUNuQkYsS0FBS0csTUFBUU4sRUFBS08sS0FDbEJKLEtBQUtLLGNBQWdCUCxFQUNyQkUsS0FBS00saUJBQW1CUCxDQUMxQixDQUVBUSxZQUFBQSxHQUtFLE9BSm9CUCxLQUFLSyxjQUN0QkcsV0FBVSxHQUNWQyxjQUFjLFFBR25CLENBRUFDLGtCQUFvQkEsS0FDbEJWLEtBQUtXLFNBQVNDLFVBQVVDLE9BQU8sMkJBQTJCLEVBRzVEQyxvQkFBc0JBLEtBQ3BCZCxLQUFLZSxhQUFhQyxTQUNsQmhCLEtBQUtlLGFBQWUsSUFBSSxFQUcxQkUsa0JBQUFBLEdBQ0VqQixLQUFLa0IsV0FBV0MsaUJBQWlCLFFBQVNuQixLQUFLTSxrQkFFL0NOLEtBQUtXLFNBQVNRLGlCQUFpQixRQUFTbkIsS0FBS1UsbUJBRTdDVixLQUFLb0IsV0FBV0QsaUJBQWlCLFFBQVNuQixLQUFLYyxvQkFDakQsQ0FFQU8sT0FBQUEsR0FjRSxPQWJBckIsS0FBS2UsYUFBZWYsS0FBS08sZUFFekJQLEtBQUtzQixXQUFhdEIsS0FBS2UsYUFBYU4sY0FBYyxnQkFDbERULEtBQUtrQixXQUFhbEIsS0FBS2UsYUFBYU4sY0FBYyxnQkFDbERULEtBQUtXLFNBQVdYLEtBQUtlLGFBQWFOLGNBQWMsc0JBQ2hEVCxLQUFLb0IsV0FBYXBCLEtBQUtlLGFBQWFOLGNBQWMsd0JBRWxEVCxLQUFLc0IsV0FBV0MsWUFBY3ZCLEtBQUtDLE9BQ25DRCxLQUFLa0IsV0FBV00sSUFBTXhCLEtBQUtDLE9BQzNCRCxLQUFLa0IsV0FBV08sSUFBTXpCLEtBQUtHLE1BRTNCSCxLQUFLaUIscUJBRUVqQixLQUFLZSxZQUNkLEdDcUNGLEVBckZBLE1BQ0VwQixXQUFBQSxDQUFZK0IsRUFBUUMsR0FDbEIzQixLQUFLNEIsZUFBaUJGLEVBQU9HLGNBQzdCN0IsS0FBSzhCLHNCQUF3QkosRUFBT0sscUJBQ3BDL0IsS0FBS2dDLHFCQUF1Qk4sRUFBT08sb0JBQ25DakMsS0FBS2tDLGlCQUFtQlIsRUFBT1MsZ0JBQy9CbkMsS0FBS29DLFlBQWNWLEVBQU9XLFdBRTFCckMsS0FBS3NDLGFBQWVYLENBQ3RCLENBRUFZLGVBQUFBLENBQWdCQyxFQUFjQyxHQUM1QixNQUFNQyxFQUFlMUMsS0FBS3NDLGFBQWE3QixjQUNwQyxJQUFHK0IsRUFBYUcsWUFHbkJILEVBQWE1QixVQUFVZ0MsSUFBSTVDLEtBQUtrQyxrQkFDaENRLEVBQWFuQixZQUFja0IsRUFDM0JDLEVBQWE5QixVQUFVZ0MsSUFBSTVDLEtBQUtvQyxZQUNsQyxDQUVBUyxlQUFBQSxDQUFnQkwsR0FDZCxNQUFNRSxFQUFlMUMsS0FBS3NDLGFBQWE3QixjQUNwQyxJQUFHK0IsRUFBYUcsWUFHbkJILEVBQWE1QixVQUFVSSxPQUFPaEIsS0FBS2tDLGtCQUNuQ1EsRUFBYW5CLFlBQWMsR0FDM0JtQixFQUFhOUIsVUFBVUksT0FBT2hCLEtBQUtvQyxZQUNyQyxDQUVBVSxrQkFBQUEsQ0FBbUJOLEdBQ1pBLEVBQWFPLFNBQVNDLE1BR3pCaEQsS0FBSzZDLGdCQUFnQkwsR0FGckJ4QyxLQUFLdUMsZ0JBQWdCQyxFQUFjQSxFQUFhUyxrQkFJcEQsQ0FFQUMsZ0JBQUFBLEdBQ0UsT0FBT2xELEtBQUttRCxXQUFXQyxNQUFNWixJQUNuQkEsRUFBYU8sU0FBU0MsT0FFbEMsQ0FFQUssa0JBQUFBLEdBQ01yRCxLQUFLa0Qsb0JBQ1BsRCxLQUFLc0QsZUFBZTFDLFVBQVVnQyxJQUFJNUMsS0FBS2dDLHNCQUN2Q2hDLEtBQUtzRCxlQUFlQyxhQUFhLFlBQVksS0FFN0N2RCxLQUFLc0QsZUFBZTFDLFVBQVVJLE9BQU9oQixLQUFLZ0Msc0JBQzFDaEMsS0FBS3NELGVBQWVFLGdCQUFnQixZQUV4QyxDQUVBQyxlQUFBQSxHQUNFekQsS0FBS3FELHFCQUVMckQsS0FBS21ELFdBQVdPLFNBQVNsQixJQUN2QnhDLEtBQUs2QyxnQkFBZ0JMLEVBQWEsR0FFdEMsQ0FFQXZCLGtCQUFBQSxHQUNFakIsS0FBS21ELFdBQWEsSUFDYm5ELEtBQUtzQyxhQUFhcUIsaUJBQWlCM0QsS0FBSzRCLGlCQUc3QzVCLEtBQUtzRCxlQUFpQnRELEtBQUtzQyxhQUFhN0IsY0FDdENULEtBQUs4Qix1QkFHUDlCLEtBQUttRCxXQUFXTyxTQUFTbEIsSUFDdkJBLEVBQWFyQixpQkFBaUIsU0FBUyxLQUNyQ25CLEtBQUtxRCxxQkFDTHJELEtBQUs4QyxtQkFBbUJOLEVBQWEsR0FDckMsR0FFTixDQUVBb0IsZ0JBQUFBLEdBQ0U1RCxLQUFLaUIsb0JBQ1AsR0NsREYsRUFoQ0EsTUFDRXRCLFdBQUFBLENBQVdDLEdBQVksSUFBWCxNQUFFaUUsR0FBT2pFLEVBQ25CSSxLQUFLOEQsT0FBU0QsQ0FDaEIsQ0FFQUUsSUFBQUEsR0FDRS9ELEtBQUs4RCxPQUFPbEQsVUFBVWdDLElBQUksZ0JBQzFCb0IsU0FBUzdDLGlCQUFpQixVQUFXbkIsS0FBS2lFLGtCQUM1QyxDQUVBQyxLQUFBQSxHQUNFbEUsS0FBSzhELE9BQU9sRCxVQUFVSSxPQUFPLGdCQUM3QmdELFNBQVNHLG9CQUFvQixVQUFXbkUsS0FBS2lFLGtCQUMvQyxDQUVBQSxrQkFBcUJHLElBQ0gsV0FBWkEsRUFBSUMsS0FDTnJFLEtBQUtrRSxPQUNQLEVBR0ZJLGlCQUFBQSxHQUNFdEUsS0FBSzhELE9BQU8zQyxpQkFBaUIsYUFBY2lELEtBRXZDQSxFQUFJRyxPQUFPM0QsVUFBVTRELFNBQVMsVUFDOUJKLEVBQUlHLE9BQU8zRCxVQUFVNEQsU0FBUyx5QkFFOUJ4RSxLQUFLa0UsT0FDUCxHQUVKLEdDU0YsRUFyQ0EsY0FBNEJPLEVBQzFCOUUsV0FBQUEsQ0FBV0MsRUFBOEI4QixHQUFRLElBQXJDLE1BQUVtQyxFQUFLLGlCQUFFYSxHQUFrQjlFLEVBQ3JDK0UsTUFBTSxDQUFFZCxVQUNSN0QsS0FBSzRFLFdBQWE1RSxLQUFLOEQsT0FDdkI5RCxLQUFLNkUsa0JBQW9CSCxFQUN6QjFFLEtBQUs0QixlQUFpQkYsRUFBT0csY0FDN0I3QixLQUFLbUQsV0FBYSxJQUNibkQsS0FBSzRFLFdBQVdqQixpQkFBaUIzRCxLQUFLNEIsZ0JBRTdDLENBRUFrRCxlQUFBQSxHQUNFLE1BQU1DLEVBQWEsQ0FBQyxFQU1wQixPQUpBL0UsS0FBS21ELFdBQVdPLFNBQVNzQixJQUN2QkQsRUFBV0MsRUFBTUMsTUFBUUQsRUFBTUUsS0FBSyxJQUcvQkgsQ0FDVCxDQUVBSSxjQUFBQSxDQUFldEYsR0FDYkcsS0FBS21ELFdBQVdPLFNBQVNzQixJQUN2QkEsRUFBTUUsTUFBUXJGLEVBQUttRixFQUFNQyxLQUFLLEdBRWxDLENBRUFYLGlCQUFBQSxHQUNFSyxNQUFNTCxvQkFDTnRFLEtBQUs0RSxXQUFXekQsaUJBQWlCLFVBQVdpRCxJQUMxQ0EsRUFBSWdCLGlCQUNKcEYsS0FBSzZFLGtCQUFrQjdFLEtBQUs4RSxtQkFDNUJWLEVBQUlHLE9BQU9jLE9BQU8sR0FFdEIsR0NwQ0YsTUEyQk0zRCxFQUFTLENBQ2I0RCxhQUFjLGVBQ2R6RCxjQUFlLGdCQUNmRSxxQkFBc0Isc0JBQ3RCRSxvQkFBcUIsOEJBQ3JCRSxnQkFBaUIsMEJBQ2pCRSxXQUFZLDZCQ3RCUmtELEVBQU0sSUNYWixNQUNFNUYsV0FBQUEsQ0FBWTZGLEdBQ1Z4RixLQUFLeUYsUUFBVUQsRUFBUUMsUUFDdkJ6RixLQUFLMEYsUUFBVUYsRUFBUUUsT0FDekIsQ0FFQUMsa0JBQUFBLEdBQ0UsT0FBT0MsTUFBTyxHQUFFNUYsS0FBS3lGLG1CQUFvQixDQUN2Q0MsUUFBUzFGLEtBQUswRixVQUNiRyxNQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFdBRXhDLENBRUFDLGVBQUFBLEdBQ0UsT0FBT1IsTUFBTyxHQUFFNUYsS0FBS3lGLGdCQUFpQixDQUNwQ0MsUUFBUzFGLEtBQUswRixVQUNiRyxNQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFdBRXhDLENBRUFFLGVBQUFBLENBQWdCQyxHQUNkLE9BQU9WLE1BQU8sR0FBRTVGLEtBQUt5RixtQkFBb0IsQ0FDdkNjLE9BQVEsUUFDUmIsUUFBUzFGLEtBQUswRixRQUNkYyxLQUFNQyxLQUFLQyxVQUFVLENBQ25CekIsS0FBTXFCLEVBQVNyQixLQUNmMEIsTUFBT0wsRUFBU00sUUFFakJmLE1BQU1DLEdBQ0hBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05DLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssV0FFeEMsQ0FFQVUsVUFBQUEsQ0FBV0MsR0FDVCxPQUFPbEIsTUFBTyxHQUFFNUYsS0FBS3lGLGdCQUFpQixDQUNwQ2MsT0FBUSxPQUNSYixRQUFTMUYsS0FBSzBGLFFBQ2RjLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJ6QixLQUFNNkIsRUFBUzVHLE1BQ2ZFLEtBQU0wRyxFQUFTMUcsU0FFaEJ5RixNQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFdBRXhDLENBRUFZLFVBQUFBLENBQVdDLEdBQ1QsT0FBT3BCLE1BQU8sR0FBRTVGLEtBQUt5RixpQkFBaUJ1QixJQUFVLENBQzlDVCxPQUFRLFNBQ1JiLFFBQVMxRixLQUFLMEYsVUFDYkcsTUFBTUMsR0FDSEEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FHTkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxXQUV4QyxDQUVBYyxPQUFBQSxDQUFRRCxHQUNOLE9BQU9wQixNQUFPLEdBQUU1RixLQUFLeUYsaUJBQWlCdUIsVUFBZ0IsQ0FDcERULE9BQVEsTUFDUmIsUUFBUzFGLEtBQUswRixVQUNiRyxNQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFdBRXhDLENBRUFlLFVBQUFBLENBQVdGLEdBQ1QsT0FBT3BCLE1BQU8sR0FBRTVGLEtBQUt5RixpQkFBaUJ1QixVQUFnQixDQUNwRFQsT0FBUSxTQUNSYixRQUFTMUYsS0FBSzBGLFVBQ2JHLE1BQU1DLEdBQ0hBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05DLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssV0FFeEMsQ0FFQWdCLGtCQUFBQSxDQUFtQi9HLEdBQ2pCLE9BQU93RixNQUFPLEdBQUU1RixLQUFLeUYsMEJBQTJCLENBQzlDYyxPQUFRLFFBQ1JiLFFBQVMxRixLQUFLMEYsUUFDZGMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQlUsT0FBUWhILE1BRVR5RixNQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFdBRXhDLEdEMUdrQixDQUNsQlYsUUFBUyxrREFDVEMsUUFBUyxDQUNQMkIsY0FBZSx1Q0FDZixlQUFnQixzQkFJZEMsRUFBY3RELFNBQVN2RCxjQUFjLG1CQUNyQzhHLEVBQWF2RCxTQUFTdkQsY0FBYyx5QkFDcEMrRyxFQUFnQnhELFNBQVN2RCxjQUFjLG1CQUN2Q2dILEVBQWlCekQsU0FBU3ZELGNBQWMsbUJBRXhDaUgsRUFBZTFELFNBQVN2RCxjQUFjLGtCQUFrQmtILFFBRXhEQyxFQUFZNUQsU0FBUzZELGVBQWUsY0FDcENDLEVBQWU5RCxTQUFTNkQsZUFBZSxrQkFDdkNFLEVBQWMvRCxTQUFTNkQsZUFBZSxxQkFFdENHLEVBQW9CaEUsU0FBUzZELGVBQWUsdUJBRTVDSSxFQUFlRCxFQUFrQnZILGNBQWMsa0JBQy9DeUgsRUFBbUJGLEVBQWtCdkgsY0FBYyxzQkFFbkQwSCxFQUFpQm5FLFNBQVN2RCxjQUFjLHlCQUN4QzJILEVBQWFwRSxTQUFTdkQsY0FBYyx5QkFDcEM0SCxFQUFnQnJFLFNBQVN2RCxjQUFjLHdCQUd2QzZILEVBQWlCLENBQUMsRUF5QmxCQyxFQUFXMUksSUFDZixNQUFNMkksRUFYWTNJLElBQ0UsSUFBSTRJLEVBQUssQ0FDM0I1SSxLQUFNQSxFQUNOQyxhQUFjNEgsRUFDZDNILGdCQUFpQkEsS0FDZjJJLEVBQVczRSxLQUFLbEUsRUFBSyxJQUdOd0IsVUFHTnNILENBQVc5SSxHQUN4QitJLEVBQVlDLFFBQVFMLEVBQUssRUFJckJNLEVBQVcsSUV2RWpCLE1BQ0VuSixXQUFBQSxDQUFXQyxHQUF3QixJQUF2QixTQUFFbUosRUFBUSxRQUFFQyxHQUFTcEosRUFDL0JJLEtBQUtpSixVQUFZRixFQUNqQi9JLEtBQUtrSixTQUFXRixDQUNsQixDQUVBRyxXQUFBQSxHQUNFLE1BQU03QyxFQUFXLENBQUMsRUFLbEIsT0FIQUEsRUFBU3JCLEtBQU9qRixLQUFLaUosVUFBVTFILFlBQy9CK0UsRUFBU00sSUFBTTVHLEtBQUtrSixTQUFTM0gsWUFFdEIrRSxDQUNULENBRUE4QyxXQUFBQSxDQUFZQyxHQUNWckosS0FBS2lKLFVBQVUxSCxZQUFjOEgsRUFBS3BFLEtBQ2xDakYsS0FBS2tKLFNBQVMzSCxZQUFjOEgsRUFBS3pDLEdBQ25DLEdGcUQ0QixDQUM1Qm1DLFNBQVV6QixFQUNWMEIsUUFBU3pCLElBR0xxQixFQUFjLElHNUVwQixNQUNFakosV0FBQUEsQ0FBV0MsRUFBc0IwSixHQUFXLElBQWhDLE1BQUVDLEVBQUssU0FBRUMsR0FBVTVKLEVBQzdCSSxLQUFLeUosT0FBU0YsRUFDZHZKLEtBQUswSixVQUFZRixFQUNqQnhKLEtBQUsySixXQUFhTCxDQUNwQixDQUVBTSxXQUFBQSxHQUNFNUosS0FBS3lKLE9BQU8vRixTQUFTbUcsSUFDbkI3SixLQUFLMEosVUFBVUcsRUFBSyxHQUV4QixDQUVBaEIsT0FBQUEsQ0FBUWdCLEdBQ043SixLQUFLMkosV0FBV0csUUFBUUQsRUFDMUIsR0g4REEsQ0FDRU4sTUQ5RWlCLENBQ25CLENBQ0VySixNQUFPLGtCQUNQRSxLQUFNLHNHQUVSLENBQ0VGLE1BQU8sY0FDUEUsS0FBTSx5R0FFUixDQUNFRixNQUFPLGlCQUNQRSxLQUFNLDRHQUVSLENBQ0VGLE1BQU8sVUFDUEUsS0FBTSxxR0FFUixDQUNFRixNQUFPLHdCQUNQRSxLQUFNLHFHQUVSLENBQ0VGLE1BQU8saUJBQ1BFLEtBQU0sbUdDd0ROb0osU0FBVWpCLEdBRVpkLEdBSUlpQixFQUFhLElJbkZuQixjQUE2QmpFLEVBQzNCOUUsV0FBQUEsQ0FBV0MsRUFBaUNpRSxHQUFPLElBQXZDLFdBQUU2RSxFQUFVLGVBQUVxQixHQUFnQm5LLEVBQ3hDK0UsTUFBTSxDQUFFZCxVQUNSN0QsS0FBSzhELE9BQVNELEVBQ2Q3RCxLQUFLZ0ssWUFBY3RCLEVBQ25CMUksS0FBS2lLLGdCQUFrQkYsQ0FDekIsQ0FFQWhHLElBQUFBLENBQUtsRSxHQUNIOEUsTUFBTVosT0FDTi9ELEtBQUtnSyxZQUFZdkksSUFBTTVCLEVBQUtPLEtBQzVCSixLQUFLZ0ssWUFBWXhJLElBQU0zQixFQUFLSyxNQUM1QkYsS0FBS2lLLGdCQUFnQjFJLFlBQWMxQixFQUFLSyxLQUMxQyxHSnVFQSxDQUNFd0ksV0FBWVQsRUFDWjhCLGVBQWdCN0IsR0FFbEJGLEdBS0lrQyxFQUFlLElBQUlDLEVBQ3ZCLENBQ0V0RyxNQUFPK0QsRUFDUGxELGlCQUFtQjBGLElBQ2pCdEIsRUFBU00sWUFBWWdCLEdBQ3JCN0UsRUFBSWMsZ0JBQWdCK0QsR0FDcEJGLEVBQWFoRyxPQUFPLEdBR3hCeEMsR0FFSTJJLEVBQWUsSUFBSUYsRUFDdkIsQ0FDRXRHLE1BQU9pRSxFQUNQcEQsaUJBQW1CNEYsSUFDakIvQixFQUFRK0IsR0FDUi9FLEVBQUlzQixXQUFXeUQsR0FDZkQsRUFBYW5HLE9BQU8sR0FHeEJ4QyxHQUVJNkksRUFBaUIsSUFBSUosRUFDekIsQ0FDRXRHLE1BQU9rRSxFQUNQckQsaUJBQW1COEYsSUFDakJoRCxFQUFjL0YsSUFBTStJLEVBQ3BCakYsRUFBSTRCLG1CQUFtQnFELEdBQ3ZCRCxFQUFlckcsT0FBTyxHQUcxQnhDLEdBdUJGeUcsRUFBZWhILGlCQUFpQixTQWhCTHNKLEtBQ3pCLE1BQU1uRSxFQUFXd0MsRUFBU0ssY0FDMUJlLEVBQWEvRSxlQUFlbUIsR0FDNUJnQyxFQUFlLGFBQWE3RSxrQkFDNUJ5RyxFQUFhbkcsTUFBTSxJQWFyQnFFLEVBQVdqSCxpQkFBaUIsU0FYRXVKLEtBQzVCcEMsRUFBZSxpQkFBaUI3RSxrQkFDaEM0RyxFQUFhdEcsTUFBTSxJQVVyQnNFLEVBQWNsSCxpQkFBaUIsU0FSRndKLEtBQzNCckMsRUFBZSxvQkFBb0I3RSxrQkFDbkM4RyxFQUFleEcsTUFBTSxJQVl2QjJFLEVBQVdwRSxvQkFDWDRGLEVBQWE1RixvQkFDYitGLEVBQWEvRixvQkFDYmlHLEVBQWVqRyxvQkFySFc1QyxLQUNQLElBQUlzQyxTQUFTTCxpQkFBaUJqQyxFQUFPNEQsZUFDN0M1QixTQUFTa0gsSUFDaEIsTUFBTUMsRUFBWSxJQUFJQyxFQUFjcEosRUFBUWtKLEdBQ3RDRyxFQUFXSCxFQUFLSSxhQUFhLFFBRW5DMUMsRUFBZXlDLEdBQVlGLEVBQzNCQSxFQUFVakgsa0JBQWtCLEdBQzVCLEVBZ0hKQSxDQUFpQmxDLEdBQ2pCa0gsRUFBWWdCLGEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljayB9KSB7XHJcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEudGl0bGU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSB0aGlzLl9jYXJkU2VsZWN0b3JcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVEZWxldGVCdXR0b24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XHJcblxyXG4gICAgdGhpcy5fbGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2xpa2VCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuXHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXAgfSkge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBwb3B1cDtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlQ2xvc2VCeUVzYyk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVDbG9zZUJ5RXNjKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVDbG9zZUJ5RXNjID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cCwgaGFuZGxlRm9ybVN1Ym1pdCB9LCBjb25maWcpIHtcclxuICAgIHN1cGVyKHsgcG9wdXAgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cDtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gW1xyXG4gICAgICAuLi50aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgdGl0bGU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICB0aXRsZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGl0bGU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIHRpdGxlOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGl0bGU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIHRpdGxlOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc2F2ZS1idXR0b25faW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxufTtcclxuXHJcbmV4cG9ydCB7IGluaXRpYWxDYXJkcywgY29uZmlnIH07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbi8vIGltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCBjb25maWcgfSBmcm9tIFwiL3NyYy91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiL3NyYy9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiOWZiZmFiMWItNjlkNi00M2E5LWIwODUtNjBkNTdiMDc0MzA5XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG5jb25zdCBwcm9maWxlR2FsbGVyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZHNcIik7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudDtcclxuXHJcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgbmV3Q2FyZE1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXctY2FyZC1tb2RhbFwiKTtcclxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImF2YXRhci1lZGl0LW1vZGFsXCIpO1xyXG4vLyBjb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVsZXRlLWNvbmZpcm1hdGlvbi1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByZXZpZXctaW1hZ2UtbW9kYWxcIik7XHJcblxyXG5jb25zdCBwcmV2aWV3SW1hZ2UgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLnByZXZpZXctaW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZVRleHQgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlLWRlc2NyaXB0aW9uXCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBuZXdDYXJkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19wbHVzLWJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFyRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdF9fYXZhdGFyLWJ1dHRvblwiKTtcclxuLy8gY29uc3QgZGVsZXRlQnV0dG9ucyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIildO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbi8vIFZhbGlkYXRpb24gZm9yIGFsbCBmb3Jtc1xyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcildO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm0pID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybSk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLy8gQ3JlYXRlIENhcmQgKyBBZGQgQ2FyZCBGdW5jdGlvbnNcclxuY29uc3QgY3JlYXRlQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZCh7XHJcbiAgICBkYXRhOiBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yOiBjYXJkVGVtcGxhdGUsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcclxuICAgICAgcG9wdXBJbWFnZS5vcGVuKGRhdGEpO1xyXG4gICAgfSxcclxuICB9KTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xyXG59O1xyXG5jb25zdCBhZGRDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICBjYXJkU2VjdGlvbi5zZXRJdGVtKGNhcmQpO1xyXG59O1xyXG5cclxuLy8gVXNlciBEYXRhXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICB1c2VyTmFtZTogcHJvZmlsZU5hbWUsXHJcbiAgdXNlckpvYjogcHJvZmlsZUpvYixcclxufSk7XHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogYWRkQ2FyZCxcclxuICB9LFxyXG4gIHByb2ZpbGVHYWxsZXJ5XHJcbik7XHJcblxyXG4vLyBQb3B1cCBJbnN0YW50aWF0aW9uc1xyXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFxyXG4gIHtcclxuICAgIHBvcHVwSW1hZ2U6IHByZXZpZXdJbWFnZSxcclxuICAgIHBvcHVwSW1hZ2VUZXh0OiBwcmV2aWV3SW1hZ2VUZXh0LFxyXG4gIH0sXHJcbiAgcHJldmlld0ltYWdlTW9kYWxcclxuKTtcclxuLy8gY29uc3QgZGVsZXRlTW9kYWxOZXcgPSBuZXcgUG9wdXAoe1xyXG4vLyAgIHBvcHVwOiBkZWxldGVNb2RhbCxcclxuLy8gfSk7XHJcbmNvbnN0IGVkaXRNb2RhbE5ldyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBlZGl0TW9kYWwsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAoZWRpdE1vZGFsRGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhlZGl0TW9kYWxEYXRhKTtcclxuICAgICAgYXBpLmVkaXRQcm9maWxlRGF0YShlZGl0TW9kYWxEYXRhKTtcclxuICAgICAgZWRpdE1vZGFsTmV3LmNsb3NlKCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY29uZmlnXHJcbik7XHJcbmNvbnN0IGNhcmRNb2RhbE5ldyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBuZXdDYXJkTW9kYWwsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAobmV3Q2FyZERhdGEpID0+IHtcclxuICAgICAgYWRkQ2FyZChuZXdDYXJkRGF0YSk7XHJcbiAgICAgIGFwaS5hZGROZXdDYXJkKG5ld0NhcmREYXRhKTtcclxuICAgICAgY2FyZE1vZGFsTmV3LmNsb3NlKCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY29uZmlnXHJcbik7XHJcbmNvbnN0IGF2YXRhck1vZGFsTmV3ID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAge1xyXG4gICAgcG9wdXA6IGF2YXRhck1vZGFsLFxyXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogKGF2YXRhckRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXJEYXRhO1xyXG4gICAgICBhcGkudXBkYXRlUHJvZmlsZUltYWdlKGF2YXRhckRhdGEpO1xyXG4gICAgICBhdmF0YXJNb2RhbE5ldy5jbG9zZSgpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGNvbmZpZ1xyXG4pO1xyXG5cclxuLy8gTWFpbnRhbmVuY2UgSGFuZGxlciBGdW5jdGlvbnNcclxuLy8gY29uc3QgaGFuZGxlRGVsZXRlUG9wdXBPcGVuID0gKCkgPT4ge1xyXG4vLyAgIGRlbGV0ZU1vZGFsTmV3Lm9wZW4oKTtcclxuLy8gfTtcclxuY29uc3QgaGFuZGxlRWRpdEZvcm1PcGVuID0gKCkgPT4ge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBlZGl0TW9kYWxOZXcuc2V0SW5wdXRWYWx1ZXModXNlckRhdGEpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZWRpdC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRNb2RhbE5ldy5vcGVuKCk7XHJcbn07XHJcbmNvbnN0IGhhbmRsZU5ld0NhcmRGb3JtT3BlbiA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcIm5ldy1jYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY2FyZE1vZGFsTmV3Lm9wZW4oKTtcclxufTtcclxuY29uc3QgaGFuZGxlQXZhdGFyRWRpdE9wZW4gPSAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJhdmF0YXItZWRpdC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGF2YXRhck1vZGFsTmV3Lm9wZW4oKTtcclxufTtcclxuXHJcbi8vIENsaWNrIEhhbmRsZXJzXHJcbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVFZGl0Rm9ybU9wZW4pO1xyXG5uZXdDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVOZXdDYXJkRm9ybU9wZW4pO1xyXG5hdmF0YXJFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBdmF0YXJFZGl0T3Blbik7XHJcbi8vIGRlbGV0ZUJ1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiB7XHJcbi8vICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVEZWxldGVQb3B1cE9wZW4pO1xyXG4vLyB9KTtcclxuXHJcbi8vIEV2ZW50IExpc3RlbmVyc1xyXG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRNb2RhbE5ldy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jYXJkTW9kYWxOZXcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYXZhdGFyTW9kYWxOZXcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gZGVsZXRlTW9kYWxOZXcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mb3JtYXRpb24oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZURhdGEodXNlckRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgICBhYm91dDogdXNlckRhdGEuam9iLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGNhcmREYXRhLnRpdGxlLFxyXG4gICAgICAgIGxpbms6IGNhcmREYXRhLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlSW1hZ2UobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZSwgdXNlckpvYiB9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IHVzZXJOYW1lO1xyXG4gICAgdGhpcy5fdXNlckpvYiA9IHVzZXJKb2I7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJEYXRhID0ge307XHJcblxyXG4gICAgdXNlckRhdGEubmFtZSA9IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50O1xyXG4gICAgdXNlckRhdGEuam9iID0gdGhpcy5fdXNlckpvYi50ZXh0Q29udGVudDtcclxuXHJcbiAgICByZXR1cm4gdXNlckRhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhpbmZvKSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IGluZm8ubmFtZTtcclxuICAgIHRoaXMuX3VzZXJKb2IudGV4dENvbnRlbnQgPSBpbmZvLmpvYjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwSW1hZ2UsIHBvcHVwSW1hZ2VUZXh0IH0sIHBvcHVwKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwIH0pO1xyXG4gICAgdGhpcy5fcG9wdXAgPSBwb3B1cDtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSBwb3B1cEltYWdlO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRleHQgPSBwb3B1cEltYWdlVGV4dDtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGRhdGEudGl0bGU7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlVGV4dC50ZXh0Q29udGVudCA9IGRhdGEudGl0bGU7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiX3JlZiIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX3RpdGxlIiwidGl0bGUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9nZXRUZW1wbGF0ZSIsImNsb25lTm9kZSIsInF1ZXJ5U2VsZWN0b3IiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9saWtlQnRuIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkSW1hZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ0biIsImdldFZpZXciLCJfY2FyZFRpdGxlIiwidGV4dENvbnRlbnQiLCJhbHQiLCJzcmMiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiYWRkIiwiX2hpZGVJbnB1dEVycm9yIiwiY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImVuYWJsZVZhbGlkYXRpb24iLCJwb3B1cCIsIl9wb3B1cCIsIm9wZW4iLCJkb2N1bWVudCIsIl9oYW5kbGVDbG9zZUJ5RXNjIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwibmFtZSIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwiZm9ybVNlbGVjdG9yIiwiYXBpIiwib3B0aW9ucyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiZ2V0VXNlckluZm9ybWF0aW9uIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImVkaXRQcm9maWxlRGF0YSIsInVzZXJEYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImpvYiIsImFkZE5ld0NhcmQiLCJjYXJkRGF0YSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlIiwiZGVsZXRlTGlrZSIsInVwZGF0ZVByb2ZpbGVJbWFnZSIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVKb2IiLCJwcm9maWxlQXZhdGFyIiwicHJvZmlsZUdhbGxlcnkiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwiZWRpdE1vZGFsIiwiZ2V0RWxlbWVudEJ5SWQiLCJuZXdDYXJkTW9kYWwiLCJhdmF0YXJNb2RhbCIsInByZXZpZXdJbWFnZU1vZGFsIiwicHJldmlld0ltYWdlIiwicHJldmlld0ltYWdlVGV4dCIsInByb2ZpbGVFZGl0QnRuIiwibmV3Q2FyZEJ0biIsImF2YXRhckVkaXRCdG4iLCJmb3JtVmFsaWRhdG9ycyIsImFkZENhcmQiLCJjYXJkIiwiQ2FyZCIsInBvcHVwSW1hZ2UiLCJjcmVhdGVDYXJkIiwiY2FyZFNlY3Rpb24iLCJzZXRJdGVtIiwidXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJKb2IiLCJfdXNlck5hbWUiLCJfdXNlckpvYiIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJpbmZvIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJwcmVwZW5kIiwicG9wdXBJbWFnZVRleHQiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cEltYWdlVGV4dCIsImVkaXRNb2RhbE5ldyIsIlBvcHVwV2l0aEZvcm0iLCJlZGl0TW9kYWxEYXRhIiwiY2FyZE1vZGFsTmV3IiwibmV3Q2FyZERhdGEiLCJhdmF0YXJNb2RhbE5ldyIsImF2YXRhckRhdGEiLCJoYW5kbGVFZGl0Rm9ybU9wZW4iLCJoYW5kbGVOZXdDYXJkRm9ybU9wZW4iLCJoYW5kbGVBdmF0YXJFZGl0T3BlbiIsImZvcm0iLCJ2YWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9