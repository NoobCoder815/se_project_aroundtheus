!function(){"use strict";var e=class{constructor(e,t,s){let{name:r,link:i,isLiked:n,_id:o}=e,{handleCardClick:a,handleCardDelete:l,handleCardLike:d}=t;this._title=r,this._link=i,this._id=o,this.isLiked=n,this._cardTemplate=s,this._handleCardClick=a,this._handleCardDelete=l,this._handleCardLike=d}_getTemplate(){return this._cardTemplate.cloneNode(!0).querySelector(".card")}setLikeStatus(e){this.isLiked=e,this._renderLike()}_renderLike=()=>{this.isLiked?this._likeBtn.classList.add("card__like-button_active"):this._likeBtn.classList.remove("card__like-button_active")};removeCard=()=>{this._cardElement.remove(),this._cardElement=null};_setEventListeners(){this._cardImage.addEventListener("click",this._handleCardClick),this._likeBtn.addEventListener("click",(()=>{this._handleCardLike(this._id)})),this._deleteBtn.addEventListener("click",this._handleCardDelete)}getView(){return this._cardElement=this._getTemplate(),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardImage=this._cardElement.querySelector(".card__image"),this._likeBtn=this._cardElement.querySelector(".card__like-button"),this._deleteBtn=this._cardElement.querySelector(".card__delete-button"),this._cardTitle.textContent=this._title,this._cardImage.alt=this._title,this._cardImage.src=this._link,this._renderLike(),this._setEventListeners(),this._cardElement}},t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleButtonState(),this.checkInputValidity(e)}))}))}enableValidation(){this._setEventListeners()}},s=class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}setItem(e){this._container.append(e)}},r=class{constructor(e){let{popup:t}=e;this._popup=t}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleCloseByEsc)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleCloseByEsc)}_handleCloseByEsc=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close-button"))&&this.close()}))}},i=class extends r{constructor(e,t){let{popup:s,handleFormSubmit:r}=e;super({popup:s}),this._handleFormSubmit=r,this._submitBtn=this._popup.querySelector(t.submitButtonSelector),this._submitBtnText=this._submitBtn.textContent,this._popupForm=this._popup.querySelector(t.formSelector),this._inputList=[...this._popup.querySelectorAll(t.inputSelector)]}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}resetForm(){this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}};const n=document.querySelector(".profile__title"),o=document.querySelector(".profile__description"),a=document.querySelector(".profile__image"),l=document.querySelector(".gallery__cards"),d=document.querySelector("#card-template").content,h=document.getElementById("edit-modal"),c=document.getElementById("new-card-modal"),u=document.getElementById("avatar-edit-modal"),_=document.getElementById("delete-confirmation-modal"),m=document.getElementById("preview-image-modal"),p=m.querySelector(".preview-image"),v=m.querySelector(".image-description"),E=document.querySelector(".profile__edit-button"),b=document.querySelector(".profile__plus-button"),L=document.querySelector(".edit__avatar-button"),g={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__confirm-button",inactiveButtonClass:"modal__confirm-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"};const S=new class{constructor(e){let{userName:t,userDescription:s,userProfileImage:r}=e;this._userName=t,this._userDescription=s,this._userProfileImage=r}getUserInfo(){const e={};return e.name=this._userName.textContent,e.about=this._userDescription.textContent,e}setUserInfo(e){this._userName.textContent=e.name,this._userDescription.textContent=e.about}setUserProfileImage(e){this._userProfileImage.src=e.avatar,this._userProfileImage.alt=this._userName.textContent}}({userName:n,userDescription:o,userProfileImage:a}),f=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInformation(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkServerResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkServerResponse)}editProfileData(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkServerResponse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})}).then(this._checkServerResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkServerResponse)}deleteLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}updateProfileImage(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._checkServerResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9fbfab1b-69d6-43a9-b085-60d57b074309","Content-Type":"application/json"}}),k=t=>{const s=new e(t,{handleCardClick:()=>I.open(t),handleCardDelete:()=>{x.open(),x.submitForm((()=>{C((function(){return f.deleteCard(t._id).then((()=>{s.removeCard()}))}),x,"Deleting...")}))},handleCardLike:e=>{s.isLiked?f.deleteLike(e).then((e=>{s.setLikeStatus(e.isLiked)})).catch(console.error):f.addLike(e).then((e=>{s.setLikeStatus(e.isLiked)})).catch(console.error)}},d);return s.getView()};function C(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.renderLoading(!0,s),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.renderLoading(!1)}))}const I=new class extends r{constructor(e,t){let{popupImage:s,popupImageText:r}=e;super({popup:t}),this._popup=t,this._popupImage=s,this._popupImageText=r}open(e){super.open(),this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupImageText.textContent=e.name}}({popupImage:p,popupImageText:v},m),y=new i({popup:h,handleFormSubmit:e=>{C((function(){return f.editProfileData(e).then((e=>{S.setUserInfo(e),y.resetForm()}))}),y)}},g),B=new i({popup:c,handleFormSubmit:e=>{C((function(){return f.addNewCard(e).then((e=>{l.prepend(k(e)),B.resetForm()}))}),B)}},g),q=new i({popup:u,handleFormSubmit:e=>{C((function(){return f.updateProfileImage(e).then((e=>{S.setUserProfileImage(e),q.resetForm()}))}),q)}},g),x=new class extends r{constructor(e,t){let{popup:s}=e;super({popup:s}),this._submitBtn=this._popup.querySelector(t.submitButtonSelector),this._submitBtnText=this._submitBtn.textContent}submitForm(e){this._handleFormSubmit=e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}({popup:_},g);E.addEventListener("click",(()=>{const e=S.getUserInfo();y.setInputValues(e),w["edit-form"].resetValidation(),y.open()})),b.addEventListener("click",(()=>{w["new-card-form"].resetValidation(),B.open()})),L.addEventListener("click",(()=>{w["avatar-edit-form"].resetValidation(),q.open()})),I.setEventListeners(),y.setEventListeners(),B.setEventListeners(),q.setEventListeners(),x.setEventListeners();const w={};(e=>{[...document.querySelectorAll(e.formSelector)].forEach((s=>{const r=new t(e,s),i=s.getAttribute("name");w[i]=r,r.enableValidation()}))})(g),Promise.all([f.getUserInformation(),f.getInitialCards()]).then((e=>{let[t,r]=e;S.setUserInfo(t),S.setUserProfileImage(t);const i=new s({items:r,renderer:e=>{const t=k(e);i.setItem(t)}},l);i.renderItems()})).catch(console.error)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VXlFLEdBQWFyTixFQUM3Qm9JLEVBQVNVLFlBQVlGLEdBQ3JCUixFQUFTWSxvQkFBb0JKLEdBQzdCLE1BQU0wRSxFQUFpQixJQUFJQyxFQUN6QixDQUNFL0ksTUFBTzZJLEVBQ1A1SSxTQUFXK0ksSUFDVCxNQUFNL0IsRUFBT1AsRUFBV3NDLEdBQ3hCRixFQUFldkksUUFBUTBHLEVBQUssR0FHaEN2QyxHQUVGb0UsRUFBZXpJLGFBQWEsSUFFN0I2RyxNQUFNQyxRQUFRQyxNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB7IG5hbWUsIGxpbmssIGlzTGlrZWQsIF9pZCB9LFxyXG4gICAgeyBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUNhcmREZWxldGUsIGhhbmRsZUNhcmRMaWtlIH0sXHJcbiAgICBjYXJkVGVtcGxhdGVcclxuICApIHtcclxuICAgIHRoaXMuX3RpdGxlID0gbmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgdGhpcy5faWQgPSBfaWQ7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gY2FyZFRlbXBsYXRlO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSA9IGhhbmRsZUNhcmREZWxldGU7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSB0aGlzLl9jYXJkVGVtcGxhdGVcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHNldExpa2VTdGF0dXMoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX3JlbmRlckxpa2UoKTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmVtb3ZlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcclxuXHJcbiAgICB0aGlzLl9saWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlKHRoaXMuX2lkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2RlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBjaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLmNoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xyXG4iLCJjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cCB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IHBvcHVwO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVDbG9zZUJ5RXNjKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUNsb3NlQnlFc2MpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUNsb3NlQnlFc2MgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwLCBoYW5kbGVGb3JtU3VibWl0IH0sIGNvbmZpZykge1xyXG4gICAgc3VwZXIoeyBwb3B1cCB9KTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fc3VibWl0QnRuID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcildO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRGb3JtKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XHJcbiIsIi8vIFByb2ZpbGUgZGF0YVxyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG4vLyBDYXJkIGdhbGxlcnkgKyBjYXJkIHRlbXBsYXRlXHJcbmNvbnN0IGNhcmRHYWxsZXJ5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkc1wiKTtcclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQ7XHJcbi8vIEFsbCBtb2RhbHNcclxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBuZXdDYXJkTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5ldy1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZhdGFyLWVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVsZXRlLWNvbmZpcm1hdGlvbi1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByZXZpZXctaW1hZ2UtbW9kYWxcIik7XHJcbi8vIFByZXZpZXcgaW1hZ2UgKyB0ZXh0XHJcbmNvbnN0IHByZXZpZXdJbWFnZSA9IHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIucHJldmlldy1pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld0ltYWdlVGV4dCA9IHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtZGVzY3JpcHRpb25cIik7XHJcbi8vIEJ1dHRvbnNcclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBuZXdDYXJkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19wbHVzLWJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFyRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdF9fYXZhdGFyLWJ1dHRvblwiKTtcclxuLy8gTW9kYWwgc2VsZWN0b3JzXHJcbmNvbnN0IGNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19jb25maXJtLWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2NvbmZpcm0tYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbn07XHJcblxyXG5leHBvcnQge1xyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICBwcm9maWxlQXZhdGFyLFxyXG4gIGNhcmRHYWxsZXJ5LFxyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBlZGl0TW9kYWwsXHJcbiAgbmV3Q2FyZE1vZGFsLFxyXG4gIGF2YXRhck1vZGFsLFxyXG4gIGRlbGV0ZUNhcmRNb2RhbCxcclxuICBwcmV2aWV3SW1hZ2VNb2RhbCxcclxuICBwcmV2aWV3SW1hZ2VUZXh0LFxyXG4gIHByZXZpZXdJbWFnZSxcclxuICBwcm9maWxlRWRpdEJ0bixcclxuICBuZXdDYXJkQnRuLFxyXG4gIGF2YXRhckVkaXRCdG4sXHJcbiAgY29uZmlnLFxyXG59O1xyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiL3NyYy9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgKiBhcyBjb25zdGFudHMgZnJvbSBcIi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi9zcmMvY29tcG9uZW50cy9BcGkuanNcIjtcclxuLy8gVXNlciBEYXRhXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICB1c2VyTmFtZTogY29uc3RhbnRzLnByb2ZpbGVOYW1lLFxyXG4gIHVzZXJEZXNjcmlwdGlvbjogY29uc3RhbnRzLnByb2ZpbGVEZXNjcmlwdGlvbixcclxuICB1c2VyUHJvZmlsZUltYWdlOiBjb25zdGFudHMucHJvZmlsZUF2YXRhcixcclxufSk7XHJcbi8vIEFwaSBJbnN0YW50aWF0aW9uXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjlmYmZhYjFiLTY5ZDYtNDNhOS1iMDg1LTYwZDU3YjA3NDMwOVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbi8vIENyZWF0ZSBDYXJkXHJcbmNvbnN0IGNyZWF0ZUNhcmQgPSAoY2FyZERhdGEpID0+IHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICB7XHJcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4gcG9wdXBJbWFnZS5vcGVuKGNhcmREYXRhKSxcclxuICAgICAgaGFuZGxlQ2FyZERlbGV0ZTogKCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZU1vZGFsTmV3Lm9wZW4oKTtcclxuICAgICAgICBkZWxldGVNb2RhbE5ldy5zdWJtaXRGb3JtKCgpID0+IHtcclxuICAgICAgICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXBpLmRlbGV0ZUNhcmQoY2FyZERhdGEuX2lkKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICBjYXJkRWxlbWVudC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBkZWxldGVNb2RhbE5ldywgXCJEZWxldGluZy4uLlwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuICAgICAgaGFuZGxlQ2FyZExpa2U6IChjYXJkKSA9PiB7XHJcbiAgICAgICAgaWYgKCFjYXJkRWxlbWVudC5pc0xpa2VkKSB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmFkZExpa2UoY2FyZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgIGNhcmRFbGVtZW50LnNldExpa2VTdGF0dXMocmVzLmlzTGlrZWQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAuZGVsZXRlTGlrZShjYXJkKVxyXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgY2FyZEVsZW1lbnQuc2V0TGlrZVN0YXR1cyhyZXMuaXNMaWtlZCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgY29uc3RhbnRzLmNhcmRUZW1wbGF0ZVxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldFZpZXcoKTtcclxufTtcclxuLy8gVW5pdmVyc2FsIGZ1bmN0aW9uIGZvciBzdWJtaXQgaGFuZGxpbmdcclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIHBvcHVwSW5zdGFuY2UsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gIHBvcHVwSW5zdGFuY2UucmVuZGVyTG9hZGluZyh0cnVlLCBsb2FkaW5nVGV4dCk7XHJcbiAgcmVxdWVzdCgpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBJbnN0YW5jZS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcbi8vIFBvcHVwIEluc3RhbnRpYXRpb25zXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXHJcbiAge1xyXG4gICAgcG9wdXBJbWFnZTogY29uc3RhbnRzLnByZXZpZXdJbWFnZSxcclxuICAgIHBvcHVwSW1hZ2VUZXh0OiBjb25zdGFudHMucHJldmlld0ltYWdlVGV4dCxcclxuICB9LFxyXG4gIGNvbnN0YW50cy5wcmV2aWV3SW1hZ2VNb2RhbFxyXG4pO1xyXG5jb25zdCBlZGl0TW9kYWxOZXcgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICB7XHJcbiAgICBwb3B1cDogY29uc3RhbnRzLmVkaXRNb2RhbCxcclxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChlZGl0TW9kYWxEYXRhKSA9PiB7XHJcbiAgICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgICAgIHJldHVybiBhcGkuZWRpdFByb2ZpbGVEYXRhKGVkaXRNb2RhbERhdGEpLnRoZW4oKGVkaXRNb2RhbERhdGEpID0+IHtcclxuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGVkaXRNb2RhbERhdGEpO1xyXG4gICAgICAgICAgZWRpdE1vZGFsTmV3LnJlc2V0Rm9ybSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZWRpdE1vZGFsTmV3KTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBjb25zdGFudHMuY29uZmlnXHJcbik7XHJcbmNvbnN0IGNhcmRNb2RhbE5ldyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBjb25zdGFudHMubmV3Q2FyZE1vZGFsLFxyXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogKG5ld0NhcmREYXRhKSA9PiB7XHJcbiAgICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgICAgIHJldHVybiBhcGkuYWRkTmV3Q2FyZChuZXdDYXJkRGF0YSkudGhlbigobmV3Q2FyZERhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0YW50cy5jYXJkR2FsbGVyeS5wcmVwZW5kKGNyZWF0ZUNhcmQobmV3Q2FyZERhdGEpKTtcclxuICAgICAgICAgIGNhcmRNb2RhbE5ldy5yZXNldEZvcm0oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGNhcmRNb2RhbE5ldyk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY29uc3RhbnRzLmNvbmZpZ1xyXG4pO1xyXG5jb25zdCBhdmF0YXJNb2RhbE5ldyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBjb25zdGFudHMuYXZhdGFyTW9kYWwsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAoYXZhdGFyRGF0YSkgPT4ge1xyXG4gICAgICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgICAgICByZXR1cm4gYXBpLnVwZGF0ZVByb2ZpbGVJbWFnZShhdmF0YXJEYXRhKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJQcm9maWxlSW1hZ2UocmVzKTtcclxuICAgICAgICAgIGF2YXRhck1vZGFsTmV3LnJlc2V0Rm9ybSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgYXZhdGFyTW9kYWxOZXcpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGNvbnN0YW50cy5jb25maWdcclxuKTtcclxuY29uc3QgZGVsZXRlTW9kYWxOZXcgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFxyXG4gIHtcclxuICAgIHBvcHVwOiBjb25zdGFudHMuZGVsZXRlQ2FyZE1vZGFsLFxyXG4gIH0sXHJcbiAgY29uc3RhbnRzLmNvbmZpZ1xyXG4pO1xyXG4vLyBIYW5kbGVyIEZ1bmN0aW9uc1xyXG5jb25zdCBoYW5kbGVFZGl0Rm9ybU9wZW4gPSAoKSA9PiB7XHJcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGVkaXRNb2RhbE5ldy5zZXRJbnB1dFZhbHVlcyh1c2VyRGF0YSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJlZGl0LWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdE1vZGFsTmV3Lm9wZW4oKTtcclxufTtcclxuY29uc3QgaGFuZGxlTmV3Q2FyZEZvcm1PcGVuID0gKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wibmV3LWNhcmQtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBjYXJkTW9kYWxOZXcub3BlbigpO1xyXG59O1xyXG5jb25zdCBoYW5kbGVBdmF0YXJFZGl0T3BlbiA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1lZGl0LWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyTW9kYWxOZXcub3BlbigpO1xyXG59O1xyXG4vLyBDbGljayBIYW5kbGVyc1xyXG5jb25zdGFudHMucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRGb3JtT3Blbik7XHJcbmNvbnN0YW50cy5uZXdDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVOZXdDYXJkRm9ybU9wZW4pO1xyXG5jb25zdGFudHMuYXZhdGFyRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQXZhdGFyRWRpdE9wZW4pO1xyXG4vLyBFdmVudCBMaXN0ZW5lcnNcclxucG9wdXBJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0TW9kYWxOZXcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY2FyZE1vZGFsTmV3LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmF2YXRhck1vZGFsTmV3LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmRlbGV0ZU1vZGFsTmV3LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIFNldCBhbmQgZW5hYmxlIHZhbGlkYXRpb24gZm9yIGFsbCBmb3Jtc1xyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcildO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm0pID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybSk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKGNvbnN0YW50cy5jb25maWcpO1xyXG4vLyBTZXJ2ZXIgcmVxdWVzdHNcclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mb3JtYXRpb24oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VyUHJvZmlsZUltYWdlKHVzZXJEYXRhKTtcclxuICAgIGNvbnN0IGFwaUNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoaW5pdGlhbENhcmQpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGluaXRpYWxDYXJkKTtcclxuICAgICAgICAgIGFwaUNhcmRTZWN0aW9uLnNldEl0ZW0oY2FyZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgY29uc3RhbnRzLmNhcmRHYWxsZXJ5XHJcbiAgICApO1xyXG4gICAgYXBpQ2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgdXNlck5hbWUsIHVzZXJEZXNjcmlwdGlvbiwgdXNlclByb2ZpbGVJbWFnZSB9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IHVzZXJOYW1lO1xyXG4gICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uID0gdXNlckRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5fdXNlclByb2ZpbGVJbWFnZSA9IHVzZXJQcm9maWxlSW1hZ2U7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJEYXRhID0ge307XHJcblxyXG4gICAgdXNlckRhdGEubmFtZSA9IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50O1xyXG4gICAgdXNlckRhdGEuYWJvdXQgPSB0aGlzLl91c2VyRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgcmV0dXJuIHVzZXJEYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oaW5mbykge1xyXG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBpbmZvLm5hbWU7XHJcbiAgICB0aGlzLl91c2VyRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBpbmZvLmFib3V0O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlclByb2ZpbGVJbWFnZShkYXRhKSB7XHJcbiAgICB0aGlzLl91c2VyUHJvZmlsZUltYWdlLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgdGhpcy5fdXNlclByb2ZpbGVJbWFnZS5hbHQgPSB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrU2VydmVyUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZURhdGEodXNlckRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogY2FyZERhdGEudGl0bGUsXHJcbiAgICAgICAgbGluazogY2FyZERhdGEubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZUltYWdlKGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLmF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBJbWFnZSwgcG9wdXBJbWFnZVRleHQgfSwgcG9wdXApIHtcclxuICAgIHN1cGVyKHsgcG9wdXAgfSk7XHJcbiAgICB0aGlzLl9wb3B1cCA9IHBvcHVwO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHBvcHVwSW1hZ2U7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlVGV4dCA9IHBvcHVwSW1hZ2VUZXh0O1xyXG4gIH1cclxuXHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRleHQudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cCB9LCBjb25maWcpIHtcclxuICAgIHN1cGVyKHsgcG9wdXAgfSk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc3VibWl0Rm9ybShjYWxsQmFjaykge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGNhbGxCYWNrO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoQ29uZmlybWF0aW9uO1xyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJfcmVmIiwiX3JlZjIiLCJjYXJkVGVtcGxhdGUiLCJuYW1lIiwibGluayIsImlzTGlrZWQiLCJfaWQiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVDYXJkRGVsZXRlIiwiaGFuZGxlQ2FyZExpa2UiLCJ0aGlzIiwiX3RpdGxlIiwiX2xpbmsiLCJfY2FyZFRlbXBsYXRlIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVDYXJkRGVsZXRlIiwiX2hhbmRsZUNhcmRMaWtlIiwiX2dldFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwicXVlcnlTZWxlY3RvciIsInNldExpa2VTdGF0dXMiLCJfcmVuZGVyTGlrZSIsIl9saWtlQnRuIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwicmVtb3ZlQ2FyZCIsIl9jYXJkRWxlbWVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkSW1hZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ0biIsImdldFZpZXciLCJfY2FyZFRpdGxlIiwidGV4dENvbnRlbnQiLCJhbHQiLCJzcmMiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiX2hpZGVJbnB1dEVycm9yIiwiY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImVuYWJsZVZhbGlkYXRpb24iLCJjb250YWluZXIiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsInNldEl0ZW0iLCJhcHBlbmQiLCJwb3B1cCIsIl9wb3B1cCIsIm9wZW4iLCJkb2N1bWVudCIsIl9oYW5kbGVDbG9zZUJ5RXNjIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnRuIiwiX3N1Ym1pdEJ0blRleHQiLCJfcG9wdXBGb3JtIiwiZm9ybVNlbGVjdG9yIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJyZXNldEZvcm0iLCJyZXNldCIsInByZXZlbnREZWZhdWx0IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwiY2FyZEdhbGxlcnkiLCJjb250ZW50IiwiZWRpdE1vZGFsIiwiZ2V0RWxlbWVudEJ5SWQiLCJuZXdDYXJkTW9kYWwiLCJhdmF0YXJNb2RhbCIsImRlbGV0ZUNhcmRNb2RhbCIsInByZXZpZXdJbWFnZU1vZGFsIiwicHJldmlld0ltYWdlIiwicHJldmlld0ltYWdlVGV4dCIsInByb2ZpbGVFZGl0QnRuIiwibmV3Q2FyZEJ0biIsImF2YXRhckVkaXRCdG4iLCJ1c2VySW5mbyIsInVzZXJOYW1lIiwidXNlckRlc2NyaXB0aW9uIiwidXNlclByb2ZpbGVJbWFnZSIsIl91c2VyTmFtZSIsIl91c2VyRGVzY3JpcHRpb24iLCJfdXNlclByb2ZpbGVJbWFnZSIsImdldFVzZXJJbmZvIiwidXNlckRhdGEiLCJhYm91dCIsInNldFVzZXJJbmZvIiwiaW5mbyIsInNldFVzZXJQcm9maWxlSW1hZ2UiLCJhdmF0YXIiLCJjb25zdGFudHMiLCJhcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrU2VydmVyUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm9ybWF0aW9uIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0SW5pdGlhbENhcmRzIiwiZWRpdFByb2ZpbGVEYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGROZXdDYXJkIiwiY2FyZERhdGEiLCJ0aXRsZSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlIiwiZGVsZXRlTGlrZSIsInVwZGF0ZVByb2ZpbGVJbWFnZSIsImF1dGhvcml6YXRpb24iLCJjcmVhdGVDYXJkIiwiY2FyZEVsZW1lbnQiLCJDYXJkIiwicG9wdXBJbWFnZSIsImRlbGV0ZU1vZGFsTmV3Iiwic3VibWl0Rm9ybSIsImhhbmRsZVN1Ym1pdCIsImNhcmQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsInJlcXVlc3QiLCJwb3B1cEluc3RhbmNlIiwiZmluYWxseSIsInBvcHVwSW1hZ2VUZXh0IiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBJbWFnZVRleHQiLCJlZGl0TW9kYWxOZXciLCJQb3B1cFdpdGhGb3JtIiwiZWRpdE1vZGFsRGF0YSIsImNhcmRNb2RhbE5ldyIsIm5ld0NhcmREYXRhIiwiYXZhdGFyTW9kYWxOZXciLCJhdmF0YXJEYXRhIiwiY2FsbEJhY2siLCJoYW5kbGVFZGl0Rm9ybU9wZW4iLCJmb3JtVmFsaWRhdG9ycyIsImhhbmRsZU5ld0NhcmRGb3JtT3BlbiIsImhhbmRsZUF2YXRhckVkaXRPcGVuIiwiZm9ybSIsInZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImFsbCIsImluaXRpYWxDYXJkcyIsImFwaUNhcmRTZWN0aW9uIiwiU2VjdGlvbiIsImluaXRpYWxDYXJkIl0sInNvdXJjZVJvb3QiOiIifQ==