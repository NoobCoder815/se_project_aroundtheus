!function(){"use strict";var e=class{constructor(e,t,s){let{name:r,link:i,isLiked:n,_id:o}=e,{handleCardClick:a,handleCardDelete:l,handleCardLike:d}=t;this._title=r,this._link=i,this._id=o,this.isLiked=n,this._cardTemplate=s,this._handleCardClick=a,this._handleCardDelete=l,this._handleCardLike=d}_getTemplate(){return this._cardTemplate.cloneNode(!0).querySelector(".card")}setLikeStatus(e){this.isLiked=e,this._renderLike()}_renderLike=()=>{this.isLiked?this._likeBtn.classList.add("card__like-button_active"):this._likeBtn.classList.remove("card__like-button_active")};removeCard=()=>{this._cardElement.remove(),this._cardElement=null};_setEventListeners(){this._cardImage.addEventListener("click",this._handleCardClick),this._likeBtn.addEventListener("click",(()=>{this._handleCardLike(this._id)})),this._deleteBtn.addEventListener("click",this._handleCardDelete)}getView(){return this._cardElement=this._getTemplate(),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardImage=this._cardElement.querySelector(".card__image"),this._likeBtn=this._cardElement.querySelector(".card__like-button"),this._deleteBtn=this._cardElement.querySelector(".card__delete-button"),this._cardTitle.textContent=this._title,this._cardImage.alt=this._title,this._cardImage.src=this._link,this._renderLike(),this._setEventListeners(),this._cardElement}},t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleButtonState(),this.checkInputValidity(e)}))}))}enableValidation(){this._setEventListeners()}},s=class{constructor(e){let{popup:t}=e;this._popup=t}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleCloseByEsc)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleCloseByEsc)}_handleCloseByEsc=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close-button"))&&this.close()}))}},r=class extends s{constructor(e,t){let{popup:s,handleFormSubmit:r}=e;super({popup:s}),this._handleFormSubmit=r,this._submitBtn=this._popup.querySelector(t.submitButtonSelector),this._submitBtnText=this._submitBtn.textContent,this._popupForm=this._popup.querySelector(t.formSelector),this._inputList=[...this._popup.querySelectorAll(t.inputSelector)]}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}resetForm(){this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}};const i=document.querySelector(".profile__title"),n=document.querySelector(".profile__description"),o=document.querySelector(".profile__image"),a=document.querySelector(".gallery__cards"),l=document.querySelector("#card-template").content,d=document.getElementById("edit-modal"),h=document.getElementById("new-card-modal"),u=document.getElementById("avatar-edit-modal"),c=document.getElementById("delete-confirmation-modal"),_=document.getElementById("preview-image-modal"),m=_.querySelector(".preview-image"),p=_.querySelector(".image-description"),v=document.querySelector(".profile__edit-button"),E=document.querySelector(".profile__plus-button"),b=document.querySelector(".edit__avatar-button"),L={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__confirm-button",inactiveButtonClass:"modal__confirm-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"};function g(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.renderLoading(!0,s),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.renderLoading(!1)}))}const S=new class{constructor(e){let{userName:t,userDescription:s,userProfileImage:r}=e;this._userName=t,this._userDescription=s,this._userProfileImage=r}getUserInfo(){const e={};return e.name=this._userName.textContent,e.about=this._userDescription.textContent,e}setUserInfo(e){this._userName.textContent=e.name,this._userDescription.textContent=e.about}setUserProfileImage(e){this._userProfileImage.src=e.avatar,this._userProfileImage.alt=this._userName.textContent}}({userName:i,userDescription:n,userProfileImage:o}),f=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInformation(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkServerResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkServerResponse)}editProfileData(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkServerResponse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})}).then(this._checkServerResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkServerResponse)}deleteLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}updateProfileImage(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._checkServerResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9fbfab1b-69d6-43a9-b085-60d57b074309","Content-Type":"application/json"}}),k=t=>{const s=(t=>{const s=new e(t,{handleCardClick:()=>I.open(t),handleCardDelete:()=>{x.open(),x.submit((()=>{g((function(){return f.deleteCard(t._id).then((()=>{s.removeCard()}))}),x,"Deleting...")}))},handleCardLike:e=>{s.isLiked?f.deleteLike(e).then((e=>{s.setLikeStatus(e.isLiked)})).catch(console.error):f.addLike(e).then((e=>{s.setLikeStatus(e.isLiked)})).catch(console.error)}},l);return s.getView()})(t);C.setItem(s)},C=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}setItem(e){this._container.prepend(e)}}({items:[],renderer:k},a),I=new class extends s{constructor(e,t){let{popupImage:s,popupImageText:r}=e;super({popup:t}),this._popup=t,this._popupImage=s,this._popupImageText=r}open(e){super.open(),this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupImageText.textContent=e.name}}({popupImage:m,popupImageText:p},_),y=new r({popup:d,handleFormSubmit:e=>{g((function(){return f.editProfileData(e).then((e=>{S.setUserInfo(e),y.resetForm()}))}),y)}},L),B=new r({popup:h,handleFormSubmit:e=>{g((function(){return f.addNewCard(e).then((e=>{k(e),B.resetForm()}))}),B)}},L),q=new r({popup:u,handleFormSubmit:e=>{handleSubmit((function(){return f.updateProfileImage(e).then((e=>{S.setUserProfileImage(e),q.resetForm()}))}),q)}},L),x=new class extends s{constructor(e,t){let{popup:s}=e;super({popup:s}),this._submitBtn=this._popup.querySelector(t.submitButtonSelector),this._submitBtnText=this._submitBtn.textContent}submit(e){this._handleSubmit=e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}}({popup:c},L);v.addEventListener("click",(()=>{const e=S.getUserInfo();y.setInputValues(e),w["edit-form"].resetValidation(),y.open()})),E.addEventListener("click",(()=>{w["new-card-form"].resetValidation(),B.open()})),b.addEventListener("click",(()=>{w["avatar-edit-form"].resetValidation(),q.open()})),I.setEventListeners(),y.setEventListeners(),B.setEventListeners(),q.setEventListeners(),x.setEventListeners();const w={};(e=>{[...document.querySelectorAll(e.formSelector)].forEach((s=>{const r=new t(e,s),i=s.getAttribute("name");w[i]=r,r.enableValidation()}))})(L),Promise.all([f.getUserInformation(),f.getInitialCards()]).then((e=>{let[t,s]=e;S.setUserInfo(t),S.setUserProfileImage(t),s.forEach((e=>k(e)))})).catch(console.error),C.renderItems()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxDQUFpQjBFLEdBRWpCVyxRQUFRNEQsSUFBSSxDQUFDdEUsRUFBSWEscUJBQXNCYixFQUFJZSxvQkFDeENuQyxNQUFLN0gsSUFBOEIsSUFBNUIwSSxFQUFVOEUsR0FBYXhOLEVBQzdCa0ksRUFBU1UsWUFBWUYsR0FDckJSLEVBQVNZLG9CQUFvQkosR0FDN0I4RSxFQUFhcEosU0FBUzRHLEdBQVNELEVBQVFDLElBQU0sSUFFOUNsRCxNQUFNQyxRQUFRQyxPQUNqQnVELEVBQVlRLGEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHsgbmFtZSwgbGluaywgaXNMaWtlZCwgX2lkIH0sXHJcbiAgICB7IGhhbmRsZUNhcmRDbGljaywgaGFuZGxlQ2FyZERlbGV0ZSwgaGFuZGxlQ2FyZExpa2UgfSxcclxuICAgIGNhcmRUZW1wbGF0ZVxyXG4gICkge1xyXG4gICAgdGhpcy5fdGl0bGUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9pZCA9IF9pZDtcclxuICAgIHRoaXMuaXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBjYXJkVGVtcGxhdGU7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlID0gaGFuZGxlQ2FyZExpa2U7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZVN0YXR1cyhpc0xpa2VkKSB7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZSgpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2UgPSAoKSA9PiB7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdG4uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICByZW1vdmVDYXJkID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xyXG5cclxuICAgIHRoaXMuX2xpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlKTtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9saWtlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl90aXRsZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG5cclxuICAgIHRoaXMuX3JlbmRlckxpa2UoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuXHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIGNoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwID0gcG9wdXA7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUNsb3NlQnlFc2MpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlQ2xvc2VCeUVzYyk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlQ2xvc2VCeUVzYyA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlLWJ1dHRvblwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXAsIGhhbmRsZUZvcm1TdWJtaXQgfSwgY29uZmlnKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwIH0pO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihjb25maWcuZm9ybVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKV07XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXNldEZvcm0oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcclxuIiwiLy8gUHJvZmlsZSBkYXRhXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbi8vIENhcmQgZ2FsbGVyeSArIGNhcmQgdGVtcGxhdGVcclxuY29uc3QgY2FyZEdhbGxlcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NhcmRzXCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudDtcclxuLy8gQWxsIG1vZGFsc1xyXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IG5ld0NhcmRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmV3LWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXItZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZWxldGUtY29uZmlybWF0aW9uLW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJldmlldy1pbWFnZS1tb2RhbFwiKTtcclxuLy8gUHJldmlldyBpbWFnZSArIHRleHRcclxuY29uc3QgcHJldmlld0ltYWdlID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5wcmV2aWV3LWltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VUZXh0ID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1kZXNjcmlwdGlvblwiKTtcclxuLy8gQnV0dG9uc1xyXG5jb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IG5ld0NhcmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BsdXMtYnV0dG9uXCIpO1xyXG5jb25zdCBhdmF0YXJFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0X19hdmF0YXItYnV0dG9uXCIpO1xyXG4vLyBNb2RhbCBzZWxlY3RvcnNcclxuY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2NvbmZpcm0tYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fY29uZmlybS1idXR0b25faW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxufTtcclxuLy8gVW5pdmVyc2FsIGZ1bmN0aW9uIGZvciBzdWJtaXQgaGFuZGxpbmdcclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIHBvcHVwSW5zdGFuY2UsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gIHBvcHVwSW5zdGFuY2UucmVuZGVyTG9hZGluZyh0cnVlLCBsb2FkaW5nVGV4dCk7XHJcbiAgcmVxdWVzdCgpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBJbnN0YW5jZS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICBwcm9maWxlQXZhdGFyLFxyXG4gIGNhcmRHYWxsZXJ5LFxyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBlZGl0TW9kYWwsXHJcbiAgbmV3Q2FyZE1vZGFsLFxyXG4gIGF2YXRhck1vZGFsLFxyXG4gIGRlbGV0ZUNhcmRNb2RhbCxcclxuICBwcmV2aWV3SW1hZ2VNb2RhbCxcclxuICBwcmV2aWV3SW1hZ2VUZXh0LFxyXG4gIHByZXZpZXdJbWFnZSxcclxuICBwcm9maWxlRWRpdEJ0bixcclxuICBuZXdDYXJkQnRuLFxyXG4gIGF2YXRhckVkaXRCdG4sXHJcbiAgY29uZmlnLFxyXG4gIGhhbmRsZVN1Ym1pdCxcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi9zcmMvY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0ICogYXMgY29uc3RhbnRzIGZyb20gXCIvc3JjL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIvc3JjL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbi8vIFVzZXIgRGF0YVxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgdXNlck5hbWU6IGNvbnN0YW50cy5wcm9maWxlTmFtZSxcclxuICB1c2VyRGVzY3JpcHRpb246IGNvbnN0YW50cy5wcm9maWxlRGVzY3JpcHRpb24sXHJcbiAgdXNlclByb2ZpbGVJbWFnZTogY29uc3RhbnRzLnByb2ZpbGVBdmF0YXIsXHJcbn0pO1xyXG4vLyBBcGkgSW5zdGFudGlhdGlvblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI5ZmJmYWIxYi02OWQ2LTQzYTktYjA4NS02MGQ1N2IwNzQzMDlcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8gQ3JlYXRlIENhcmRcclxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkRGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXHJcbiAgICBjYXJkRGF0YSxcclxuICAgIHtcclxuICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiBwb3B1cEltYWdlLm9wZW4oY2FyZERhdGEpLFxyXG4gICAgICBoYW5kbGVDYXJkRGVsZXRlOiAoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ29uZmlybWF0aW9uLm9wZW4oKTtcclxuICAgICAgICBkZWxldGVDb25maXJtYXRpb24uc3VibWl0KCgpID0+IHtcclxuICAgICAgICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXBpLmRlbGV0ZUNhcmQoY2FyZERhdGEuX2lkKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICBjYXJkRWxlbWVudC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29uc3RhbnRzLmhhbmRsZVN1Ym1pdChcclxuICAgICAgICAgICAgbWFrZVJlcXVlc3QsXHJcbiAgICAgICAgICAgIGRlbGV0ZUNvbmZpcm1hdGlvbixcclxuICAgICAgICAgICAgXCJEZWxldGluZy4uLlwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG4gICAgICBoYW5kbGVDYXJkTGlrZTogKGNhcmRJZCkgPT4ge1xyXG4gICAgICAgIGlmICghY2FyZEVsZW1lbnQuaXNMaWtlZCkge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5hZGRMaWtlKGNhcmRJZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgIGNhcmRFbGVtZW50LnNldExpa2VTdGF0dXMocmVzLmlzTGlrZWQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAuZGVsZXRlTGlrZShjYXJkSWQpXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICBjYXJkRWxlbWVudC5zZXRMaWtlU3RhdHVzKHJlcy5pc0xpa2VkKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBjb25zdGFudHMuY2FyZFRlbXBsYXRlXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xyXG59O1xyXG4vLyBBZGQgY2FyZFxyXG5jb25zdCBhZGRDYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gIGNhcmRTZWN0aW9uLnNldEl0ZW0oY2FyZCk7XHJcbn07XHJcbi8vIENhcmQgc2VjdGlvblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBbXSxcclxuICAgIHJlbmRlcmVyOiBhZGRDYXJkLFxyXG4gIH0sXHJcbiAgY29uc3RhbnRzLmNhcmRHYWxsZXJ5XHJcbik7XHJcbi8vIFBvcHVwIEluc3RhbnRpYXRpb25zXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXHJcbiAge1xyXG4gICAgcG9wdXBJbWFnZTogY29uc3RhbnRzLnByZXZpZXdJbWFnZSxcclxuICAgIHBvcHVwSW1hZ2VUZXh0OiBjb25zdGFudHMucHJldmlld0ltYWdlVGV4dCxcclxuICB9LFxyXG4gIGNvbnN0YW50cy5wcmV2aWV3SW1hZ2VNb2RhbFxyXG4pO1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICB7XHJcbiAgICBwb3B1cDogY29uc3RhbnRzLmVkaXRNb2RhbCxcclxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChlZGl0Rm9ybURhdGEpID0+IHtcclxuICAgICAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIGFwaS5lZGl0UHJvZmlsZURhdGEoZWRpdEZvcm1EYXRhKS50aGVuKChlZGl0Rm9ybURhdGEpID0+IHtcclxuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGVkaXRGb3JtRGF0YSk7XHJcbiAgICAgICAgICBlZGl0UHJvZmlsZUZvcm0ucmVzZXRGb3JtKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3RhbnRzLmhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZWRpdFByb2ZpbGVGb3JtKTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBjb25zdGFudHMuY29uZmlnXHJcbik7XHJcbmNvbnN0IG5ld0NhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAge1xyXG4gICAgcG9wdXA6IGNvbnN0YW50cy5uZXdDYXJkTW9kYWwsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAobmV3Q2FyZERhdGEpID0+IHtcclxuICAgICAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIGFwaS5hZGROZXdDYXJkKG5ld0NhcmREYXRhKS50aGVuKChuZXdDYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgYWRkQ2FyZChuZXdDYXJkRGF0YSk7XHJcbiAgICAgICAgICBuZXdDYXJkRm9ybS5yZXNldEZvcm0oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdGFudHMuaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBuZXdDYXJkRm9ybSk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY29uc3RhbnRzLmNvbmZpZ1xyXG4pO1xyXG5jb25zdCBhdmF0YXJFZGl0Rm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBjb25zdGFudHMuYXZhdGFyTW9kYWwsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAoYXZhdGFyRGF0YSkgPT4ge1xyXG4gICAgICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgICAgICByZXR1cm4gYXBpLnVwZGF0ZVByb2ZpbGVJbWFnZShhdmF0YXJEYXRhKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJQcm9maWxlSW1hZ2UocmVzKTtcclxuICAgICAgICAgIGF2YXRhckVkaXRGb3JtLnJlc2V0Rm9ybSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgYXZhdGFyRWRpdEZvcm0pO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGNvbnN0YW50cy5jb25maWdcclxuKTtcclxuY29uc3QgZGVsZXRlQ29uZmlybWF0aW9uID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcclxuICB7XHJcbiAgICBwb3B1cDogY29uc3RhbnRzLmRlbGV0ZUNhcmRNb2RhbCxcclxuICB9LFxyXG4gIGNvbnN0YW50cy5jb25maWdcclxuKTtcclxuLy8gSGFuZGxlciBGdW5jdGlvbnNcclxuY29uc3QgaGFuZGxlRWRpdEZvcm1PcGVuID0gKCkgPT4ge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBlZGl0UHJvZmlsZUZvcm0uc2V0SW5wdXRWYWx1ZXModXNlckRhdGEpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZWRpdC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQcm9maWxlRm9ybS5vcGVuKCk7XHJcbn07XHJcbmNvbnN0IGhhbmRsZU5ld0NhcmRGb3JtT3BlbiA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcIm5ldy1jYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgbmV3Q2FyZEZvcm0ub3BlbigpO1xyXG59O1xyXG5jb25zdCBoYW5kbGVBdmF0YXJFZGl0T3BlbiA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1lZGl0LWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyRWRpdEZvcm0ub3BlbigpO1xyXG59O1xyXG4vLyBDbGljayBIYW5kbGVyc1xyXG5jb25zdGFudHMucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRGb3JtT3Blbik7XHJcbmNvbnN0YW50cy5uZXdDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVOZXdDYXJkRm9ybU9wZW4pO1xyXG5jb25zdGFudHMuYXZhdGFyRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQXZhdGFyRWRpdE9wZW4pO1xyXG4vLyBFdmVudCBMaXN0ZW5lcnNcclxucG9wdXBJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxubmV3Q2FyZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYXZhdGFyRWRpdEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZGVsZXRlQ29uZmlybWF0aW9uLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIFNldCBhbmQgZW5hYmxlIHZhbGlkYXRpb24gZm9yIGFsbCBmb3Jtc1xyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcildO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm0pID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybSk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKGNvbnN0YW50cy5jb25maWcpO1xyXG4vLyBTZXJ2ZXIgcmVxdWVzdHNcclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mb3JtYXRpb24oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VyUHJvZmlsZUltYWdlKHVzZXJEYXRhKTtcclxuICAgIGluaXRpYWxDYXJkcy5mb3JFYWNoKChjYXJkKSA9PiBhZGRDYXJkKGNhcmQpKTtcclxuICB9KVxyXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgdXNlck5hbWUsIHVzZXJEZXNjcmlwdGlvbiwgdXNlclByb2ZpbGVJbWFnZSB9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IHVzZXJOYW1lO1xyXG4gICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uID0gdXNlckRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5fdXNlclByb2ZpbGVJbWFnZSA9IHVzZXJQcm9maWxlSW1hZ2U7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJEYXRhID0ge307XHJcblxyXG4gICAgdXNlckRhdGEubmFtZSA9IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50O1xyXG4gICAgdXNlckRhdGEuYWJvdXQgPSB0aGlzLl91c2VyRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgcmV0dXJuIHVzZXJEYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oaW5mbykge1xyXG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBpbmZvLm5hbWU7XHJcbiAgICB0aGlzLl91c2VyRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBpbmZvLmFib3V0O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlclByb2ZpbGVJbWFnZShkYXRhKSB7XHJcbiAgICB0aGlzLl91c2VyUHJvZmlsZUltYWdlLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgdGhpcy5fdXNlclByb2ZpbGVJbWFnZS5hbHQgPSB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrU2VydmVyUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZURhdGEodXNlckRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogY2FyZERhdGEudGl0bGUsXHJcbiAgICAgICAgbGluazogY2FyZERhdGEubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZUltYWdlKGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLmF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwSW1hZ2UsIHBvcHVwSW1hZ2VUZXh0IH0sIHBvcHVwKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwIH0pO1xyXG4gICAgdGhpcy5fcG9wdXAgPSBwb3B1cDtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSBwb3B1cEltYWdlO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRleHQgPSBwb3B1cEltYWdlVGV4dDtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VUZXh0LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXAgfSwgY29uZmlnKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwIH0pO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIHN1Ym1pdChjYWxsQmFjaykge1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gY2FsbEJhY2s7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnRuVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aENvbmZpcm1hdGlvbjtcclxuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiX3JlZiIsIl9yZWYyIiwiY2FyZFRlbXBsYXRlIiwibmFtZSIsImxpbmsiLCJpc0xpa2VkIiwiX2lkIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZSIsImhhbmRsZUNhcmRMaWtlIiwidGhpcyIsIl90aXRsZSIsIl9saW5rIiwiX2NhcmRUZW1wbGF0ZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlQ2FyZERlbGV0ZSIsIl9oYW5kbGVDYXJkTGlrZSIsIl9nZXRUZW1wbGF0ZSIsImNsb25lTm9kZSIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRMaWtlU3RhdHVzIiwiX3JlbmRlckxpa2UiLCJfbGlrZUJ0biIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInJlbW92ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEltYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVCdG4iLCJnZXRWaWV3IiwiX2NhcmRUaXRsZSIsInRleHRDb250ZW50IiwiYWx0Iiwic3JjIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsIl9oaWRlSW5wdXRFcnJvciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0Iiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9idXR0b25FbGVtZW50Iiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwicmVzZXRWYWxpZGF0aW9uIiwiZm9yRWFjaCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbmFibGVWYWxpZGF0aW9uIiwicG9wdXAiLCJfcG9wdXAiLCJvcGVuIiwiZG9jdW1lbnQiLCJfaGFuZGxlQ2xvc2VCeUVzYyIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cCIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ0biIsIl9zdWJtaXRCdG5UZXh0IiwiX3BvcHVwRm9ybSIsImZvcm1TZWxlY3RvciIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXRGb3JtIiwicmVzZXQiLCJwcmV2ZW50RGVmYXVsdCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsImNhcmRHYWxsZXJ5IiwiY29udGVudCIsImVkaXRNb2RhbCIsImdldEVsZW1lbnRCeUlkIiwibmV3Q2FyZE1vZGFsIiwiYXZhdGFyTW9kYWwiLCJkZWxldGVDYXJkTW9kYWwiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsInByZXZpZXdJbWFnZSIsInByZXZpZXdJbWFnZVRleHQiLCJwcm9maWxlRWRpdEJ0biIsIm5ld0NhcmRCdG4iLCJhdmF0YXJFZGl0QnRuIiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsInBvcHVwSW5zdGFuY2UiLCJ0aGVuIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwidXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJEZXNjcmlwdGlvbiIsInVzZXJQcm9maWxlSW1hZ2UiLCJfdXNlck5hbWUiLCJfdXNlckRlc2NyaXB0aW9uIiwiX3VzZXJQcm9maWxlSW1hZ2UiLCJnZXRVc2VySW5mbyIsInVzZXJEYXRhIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsImluZm8iLCJzZXRVc2VyUHJvZmlsZUltYWdlIiwiYXZhdGFyIiwiY29uc3RhbnRzIiwiYXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9jaGVja1NlcnZlclJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvcm1hdGlvbiIsImZldGNoIiwiZ2V0SW5pdGlhbENhcmRzIiwiZWRpdFByb2ZpbGVEYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGROZXdDYXJkIiwiY2FyZERhdGEiLCJ0aXRsZSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlIiwiZGVsZXRlTGlrZSIsInVwZGF0ZVByb2ZpbGVJbWFnZSIsImF1dGhvcml6YXRpb24iLCJhZGRDYXJkIiwiY2FyZCIsImNhcmRFbGVtZW50IiwiQ2FyZCIsInBvcHVwSW1hZ2UiLCJkZWxldGVDb25maXJtYXRpb24iLCJzdWJtaXQiLCJjcmVhdGVDYXJkIiwiY2FyZFNlY3Rpb24iLCJzZXRJdGVtIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJwcmVwZW5kIiwicG9wdXBJbWFnZVRleHQiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cEltYWdlVGV4dCIsImVkaXRQcm9maWxlRm9ybSIsIlBvcHVwV2l0aEZvcm0iLCJlZGl0Rm9ybURhdGEiLCJuZXdDYXJkRm9ybSIsIm5ld0NhcmREYXRhIiwiYXZhdGFyRWRpdEZvcm0iLCJhdmF0YXJEYXRhIiwiY2FsbEJhY2siLCJfaGFuZGxlU3VibWl0IiwiaGFuZGxlRWRpdEZvcm1PcGVuIiwiZm9ybVZhbGlkYXRvcnMiLCJoYW5kbGVOZXdDYXJkRm9ybU9wZW4iLCJoYW5kbGVBdmF0YXJFZGl0T3BlbiIsImZvcm0iLCJ2YWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJhbGwiLCJpbml0aWFsQ2FyZHMiXSwic291cmNlUm9vdCI6IiJ9