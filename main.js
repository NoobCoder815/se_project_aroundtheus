!function(){"use strict";var e=class{constructor(e,t,s){let{name:r,link:i,isLiked:n,_id:o}=e,{handleCardClick:a,handleCardDelete:l,handleCardLike:d}=t;this._title=r,this._link=i,this._id=o,this.isLiked=n,this._cardTemplate=s,this._handleCardClick=a,this._handleCardDelete=l,this._handleCardLike=d}_getTemplate(){return this._cardTemplate.cloneNode(!0).querySelector(".card")}setLikeStatus(e){this.isLiked=e,this._renderLike()}_renderLike=()=>{this.isLiked?this._likeBtn.classList.add("card__like-button_active"):this._likeBtn.classList.remove("card__like-button_active")};removeCard=()=>{this._cardElement.remove(),this._cardElement=null};_setEventListeners(){this._cardImage.addEventListener("click",this._handleCardClick),this._likeBtn.addEventListener("click",(()=>{this._handleCardLike(this._id)})),this._deleteBtn.addEventListener("click",this._handleCardDelete)}getView(){return this._cardElement=this._getTemplate(),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardImage=this._cardElement.querySelector(".card__image"),this._likeBtn=this._cardElement.querySelector(".card__like-button"),this._deleteBtn=this._cardElement.querySelector(".card__delete-button"),this._cardTitle.textContent=this._title,this._cardImage.alt=this._title,this._cardImage.src=this._link,this._renderLike(),this._setEventListeners(),this._cardElement}},t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleButtonState(),this.checkInputValidity(e)}))}))}enableValidation(){this._setEventListeners()}},s=class{constructor(e){let{popup:t}=e;this._popup=t}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleCloseByEsc)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleCloseByEsc)}_handleCloseByEsc=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close-button"))&&this.close()}))}},r=class extends s{constructor(e,t){let{popup:s,handleFormSubmit:r}=e;super({popup:s}),this._handleFormSubmit=r,this._popupForm=this._popup.querySelector(t.formSelector),this._inputList=[...this._popup.querySelectorAll(t.inputSelector)],this._submitBtn=this._popup.querySelector(t.submitButtonSelector),this._submitBtnText=this._submitBtn.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}resetForm(){this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}};const i=document.querySelector(".profile__title"),n=document.querySelector(".profile__description"),o=document.querySelector(".profile__image"),a=document.querySelector(".gallery__cards"),l=document.querySelector("#card-template").content,d=document.getElementById("edit-modal"),h=document.getElementById("new-card-modal"),c=document.getElementById("avatar-edit-modal"),u=document.getElementById("delete-confirmation-modal"),_=document.getElementById("preview-image-modal"),m=_.querySelector(".preview-image"),p=_.querySelector(".image-name"),v=document.querySelector(".edit-profile-button"),E=document.querySelector(".add-new-card-button"),b=document.querySelector(".edit-avatar-button"),L={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__confirm-button",inactiveButtonClass:"modal__confirm-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"};function S(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.renderLoading(!0,s),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.renderLoading(!1)}))}const f=new class{constructor(e,t,s){this._userName=e,this._userDescription=t,this._userProfileImage=s}getUserInfo(){const e={};return e.name=this._userName.textContent,e.about=this._userDescription.textContent,e}setUserInfo(e){this._userName.textContent=e.name,this._userDescription.textContent=e.about}setUserProfileImage(e){this._userProfileImage.src=e.avatar,this._userProfileImage.alt=this._userName.textContent}}(i,n,o),g=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInformation(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkServerResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkServerResponse)}editProfileData(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkServerResponse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})}).then(this._checkServerResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkServerResponse)}deleteLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}updateProfileImage(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._checkServerResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9fbfab1b-69d6-43a9-b085-60d57b074309","Content-Type":"application/json"}}),k=t=>{const s=(t=>{const s=new e(t,{handleCardClick:()=>I.open(t),handleCardDelete:()=>{w.open(),w.submit((()=>{S((function(){return g.deleteCard(t._id).then(s.removeCard())}),w,"Deleting...")}))},handleCardLike:e=>{s.isLiked?g.deleteLike(e).then((e=>s.setLikeStatus(e.isLiked))).catch(console.error):g.addLike(e).then((e=>s.setLikeStatus(e.isLiked))).catch(console.error)}},l);return s.getView()})(t);C.setItem(s)},C=new class{constructor(e,t){this._renderer=e,this._container=t}renderItems(e){e.forEach((e=>{this._renderer(e)}))}setItem(e){this._container.prepend(e)}}(k,a),I=new class extends s{constructor(e,t,s){super({popup:s}),this._popupImage=e,this._popupImageText=t}open(e){super.open(),this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupImageText.textContent=e.name}}(m,p,_),y=new r({popup:d,handleFormSubmit:e=>{S((function(){return g.editProfileData(e).then((e=>{f.setUserInfo(e),y.resetForm()}))}),y)}},L),B=new r({popup:h,handleFormSubmit:e=>{S((function(){return g.addNewCard(e).then((e=>{k(e),B.resetForm()}))}),B)}},L),q=new r({popup:c,handleFormSubmit:e=>{S((function(){return g.updateProfileImage(e).then((e=>{f.setUserProfileImage(e),q.resetForm()}))}),q)}},L),w=new class extends s{constructor(e,t){super({popup:e}),this._submitBtn=this._popup.querySelector(t.submitButtonSelector),this._submitBtnText=this._submitBtn.textContent}submit(e){this._handleSubmit=e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}}(u,L);v.addEventListener("click",(()=>{y.setInputValues(f.getUserInfo()),x["edit-form"].resetValidation(),y.open()})),E.addEventListener("click",(()=>{x["new-card-form"].resetValidation(),B.open()})),b.addEventListener("click",(()=>{x["avatar-edit-form"].resetValidation(),q.open()})),I.setEventListeners(),y.setEventListeners(),B.setEventListeners(),q.setEventListeners(),w.setEventListeners();const x={};(e=>{[...document.querySelectorAll(e.formSelector)].forEach((s=>{const r=new t(e,s),i=s.getAttribute("name");x[i]=r,r.enableValidation()}))})(L),Promise.all([g.getUserInformation(),g.getInitialCards()]).then((e=>{let[t,s]=e;f.setUserInfo(t),f.setUserProfileImage(t),C.renderItems(s)})).catch(console.error)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxHQUNFSyxNQUFNTCxvQkFDTnRFLEtBQUs4RCxPQUFPMUMsaUJBQWlCLFVBQVdnRCxJQUN0Q0EsRUFBSTJCLGlCQUNKL0YsS0FBS2tNLGVBQWUsR0FFeEIsR0wwRkE1RCxFQUNBQSxHQWlCRkEsRUFBQUEsaUJBQTBDLFNBZGY2RCxLQUN6QlQsRUFBZ0JyRyxlQUFlbUMsRUFBU08sZUFDeENxRSxFQUFlLGFBQWEzSSxrQkFDNUJpSSxFQUFnQjNILE1BQU0sSUFZeEJ1RSxFQUFBQSxpQkFBc0MsU0FWUitELEtBQzVCRCxFQUFlLGlCQUFpQjNJLGtCQUNoQ29JLEVBQVk5SCxNQUFNLElBU3BCdUUsRUFBQUEsaUJBQXlDLFNBUFpnRSxLQUMzQkYsRUFBZSxvQkFBb0IzSSxrQkFDbkNzSSxFQUFlaEksTUFBTSxJQU92QjBHLEVBQVduRyxvQkFDWG9ILEVBQWdCcEgsb0JBQ2hCdUgsRUFBWXZILG9CQUNaeUgsRUFBZXpILG9CQUNmb0csRUFBbUJwRyxvQkFFbkIsTUFBTThILEVBQWlCLENBQUMsRUFDRXpLLEtBQ1AsSUFBSXFDLFNBQVNMLGlCQUFpQmhDLEVBQU9tRCxlQUM3Q3BCLFNBQVM2SSxJQUNoQixNQUFNQyxFQUFZLElBQUlDLEVBQWM5SyxFQUFRNEssR0FDdENHLEVBQVdILEVBQUtJLGFBQWEsUUFFbkNQLEVBQWVNLEdBQVlGLEVBQzNCQSxFQUFVNUksa0JBQWtCLEdBQzVCLEVBRUpBLENBQWlCMEUsR0FFakJXLFFBQVEyRCxJQUFJLENBQUNyRSxFQUFJYSxxQkFBc0JiLEVBQUllLG9CQUN4Q25DLE1BQUs3SCxJQUE4QixJQUE1QjBJLEVBQVU2RSxHQUFhdk4sRUFDN0JrSSxFQUFTVSxZQUFZRixHQUNyQlIsRUFBU1ksb0JBQW9CSixHQUM3QjZDLEVBQVlNLFlBQVkwQixFQUFhLElBRXRDekYsTUFBTUMsUUFBUUMsTSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB7IG5hbWUsIGxpbmssIGlzTGlrZWQsIF9pZCB9LFxyXG4gICAgeyBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUNhcmREZWxldGUsIGhhbmRsZUNhcmRMaWtlIH0sXHJcbiAgICBjYXJkVGVtcGxhdGVcclxuICApIHtcclxuICAgIHRoaXMuX3RpdGxlID0gbmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgdGhpcy5faWQgPSBfaWQ7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gY2FyZFRlbXBsYXRlO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSA9IGhhbmRsZUNhcmREZWxldGU7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSB0aGlzLl9jYXJkVGVtcGxhdGVcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHNldExpa2VTdGF0dXMoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX3JlbmRlckxpa2UoKTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmVtb3ZlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcclxuXHJcbiAgICB0aGlzLl9saWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlKHRoaXMuX2lkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2RlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBjaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLmNoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cCB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IHBvcHVwO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVDbG9zZUJ5RXNjKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUNsb3NlQnlFc2MpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUNsb3NlQnlFc2MgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwLCBoYW5kbGVGb3JtU3VibWl0IH0sIGNvbmZpZykge1xyXG4gICAgc3VwZXIoeyBwb3B1cCB9KTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihjb25maWcuZm9ybVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRGb3JtKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XHJcbiIsIi8vIFByb2ZpbGUgZGF0YVxyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbi8vIENhcmQgZ2FsbGVyeSArIGNhcmQgdGVtcGxhdGVcclxuY29uc3QgY2FyZEdhbGxlcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NhcmRzXCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudDtcclxuLy8gQWxsIG1vZGFsc1xyXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IG5ld0NhcmRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmV3LWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXItZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlbGV0ZS1jb25maXJtYXRpb24tbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xyXG4vLyBQcmV2aWV3IGltYWdlICsgdGV4dFxyXG5jb25zdCBwcmV2aWV3SW1hZ2UgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLnByZXZpZXctaW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZVRleHQgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlLW5hbWVcIik7XHJcbi8vIEJ1dHRvbnNcclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtcHJvZmlsZS1idXR0b25cIik7XHJcbmNvbnN0IG5ld0NhcmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1uZXctY2FyZC1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhckVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtYXZhdGFyLWJ1dHRvblwiKTtcclxuLy8gTW9kYWwgc2VsZWN0b3JzXHJcbmNvbnN0IGNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19jb25maXJtLWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2NvbmZpcm0tYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbn07XHJcblxyXG5leHBvcnQge1xyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICBwcm9maWxlSW1hZ2UsXHJcbiAgY2FyZEdhbGxlcnksXHJcbiAgY2FyZFRlbXBsYXRlLFxyXG4gIGVkaXRNb2RhbCxcclxuICBuZXdDYXJkTW9kYWwsXHJcbiAgYXZhdGFyTW9kYWwsXHJcbiAgZGVsZXRlTW9kYWwsXHJcbiAgcHJldmlld0ltYWdlTW9kYWwsXHJcbiAgcHJldmlld0ltYWdlVGV4dCxcclxuICBwcmV2aWV3SW1hZ2UsXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgbmV3Q2FyZEJ0bixcclxuICBhdmF0YXJFZGl0QnRuLFxyXG4gIGNvbmZpZyxcclxufTtcclxuIiwiLy8gVW5pdmVyc2FsIGZ1bmN0aW9uIGZvciBzdWJtaXQgaGFuZGxpbmdcclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIHBvcHVwSW5zdGFuY2UsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gIHBvcHVwSW5zdGFuY2UucmVuZGVyTG9hZGluZyh0cnVlLCBsb2FkaW5nVGV4dCk7XHJcbiAgcmVxdWVzdCgpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBJbnN0YW5jZS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgeyBoYW5kbGVTdWJtaXQgfTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCAqIGFzIGNvbnN0YW50cyBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCB7IGhhbmRsZVN1Ym1pdCB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG4vLyBVc2VyIERhdGFcclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXHJcbiAgY29uc3RhbnRzLnByb2ZpbGVOYW1lLFxyXG4gIGNvbnN0YW50cy5wcm9maWxlRGVzY3JpcHRpb24sXHJcbiAgY29uc3RhbnRzLnByb2ZpbGVJbWFnZVxyXG4pO1xyXG4vLyBBcGkgSW5zdGFudGlhdGlvblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI5ZmJmYWIxYi02OWQ2LTQzYTktYjA4NS02MGQ1N2IwNzQzMDlcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG4vLyBDcmVhdGUgQ2FyZFxyXG5jb25zdCBjcmVhdGVDYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAge1xyXG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHBvcHVwSW1hZ2Uub3BlbihjYXJkRGF0YSksXHJcbiAgICAgIGhhbmRsZUNhcmREZWxldGU6ICgpID0+IHtcclxuICAgICAgICBkZWxldGVDb25maXJtYXRpb24ub3BlbigpO1xyXG4gICAgICAgIGRlbGV0ZUNvbmZpcm1hdGlvbi5zdWJtaXQoKCkgPT4ge1xyXG4gICAgICAgICAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhcGkuZGVsZXRlQ2FyZChjYXJkRGF0YS5faWQpLnRoZW4oY2FyZEVsZW1lbnQucmVtb3ZlQ2FyZCgpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZGVsZXRlQ29uZmlybWF0aW9uLCBcIkRlbGV0aW5nLi4uXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG4gICAgICBoYW5kbGVDYXJkTGlrZTogKGNhcmRJZCkgPT4ge1xyXG4gICAgICAgIGlmICghY2FyZEVsZW1lbnQuaXNMaWtlZCkge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5hZGRMaWtlKGNhcmRJZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gY2FyZEVsZW1lbnQuc2V0TGlrZVN0YXR1cyhyZXMuaXNMaWtlZCkpXHJcbiAgICAgICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5kZWxldGVMaWtlKGNhcmRJZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gY2FyZEVsZW1lbnQuc2V0TGlrZVN0YXR1cyhyZXMuaXNMaWtlZCkpXHJcbiAgICAgICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgY29uc3RhbnRzLmNhcmRUZW1wbGF0ZVxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldFZpZXcoKTtcclxufTtcclxuLy8gQWRkIGNhcmRcclxuY29uc3QgYWRkQ2FyZCA9IChjYXJkRGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICBjYXJkU2VjdGlvbi5zZXRJdGVtKGNhcmQpO1xyXG59O1xyXG4vLyBDYXJkIHNlY3Rpb25cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihhZGRDYXJkLCBjb25zdGFudHMuY2FyZEdhbGxlcnkpO1xyXG4vLyBQb3B1cCBJbnN0YW50aWF0aW9uc1xyXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFxyXG4gIGNvbnN0YW50cy5wcmV2aWV3SW1hZ2UsXHJcbiAgY29uc3RhbnRzLnByZXZpZXdJbWFnZVRleHQsXHJcbiAgY29uc3RhbnRzLnByZXZpZXdJbWFnZU1vZGFsXHJcbik7XHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBjb25zdGFudHMuZWRpdE1vZGFsLFxyXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogKGVkaXRGb3JtRGF0YSkgPT4ge1xyXG4gICAgICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgICAgICByZXR1cm4gYXBpLmVkaXRQcm9maWxlRGF0YShlZGl0Rm9ybURhdGEpLnRoZW4oKGVkaXRGb3JtRGF0YSkgPT4ge1xyXG4gICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oZWRpdEZvcm1EYXRhKTtcclxuICAgICAgICAgIGVkaXRQcm9maWxlRm9ybS5yZXNldEZvcm0oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGVkaXRQcm9maWxlRm9ybSk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY29uc3RhbnRzLmNvbmZpZ1xyXG4pO1xyXG5jb25zdCBuZXdDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBjb25zdGFudHMubmV3Q2FyZE1vZGFsLFxyXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogKG5ld0NhcmREYXRhKSA9PiB7XHJcbiAgICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgICAgIHJldHVybiBhcGkuYWRkTmV3Q2FyZChuZXdDYXJkRGF0YSkudGhlbigobmV3Q2FyZERhdGEpID0+IHtcclxuICAgICAgICAgIGFkZENhcmQobmV3Q2FyZERhdGEpO1xyXG4gICAgICAgICAgbmV3Q2FyZEZvcm0ucmVzZXRGb3JtKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBuZXdDYXJkRm9ybSk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY29uc3RhbnRzLmNvbmZpZ1xyXG4pO1xyXG5jb25zdCBhdmF0YXJFZGl0Rm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHtcclxuICAgIHBvcHVwOiBjb25zdGFudHMuYXZhdGFyTW9kYWwsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAoYXZhdGFyRGF0YSkgPT4ge1xyXG4gICAgICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgICAgICByZXR1cm4gYXBpLnVwZGF0ZVByb2ZpbGVJbWFnZShhdmF0YXJEYXRhKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJQcm9maWxlSW1hZ2UocmVzKTtcclxuICAgICAgICAgIGF2YXRhckVkaXRGb3JtLnJlc2V0Rm9ybSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgYXZhdGFyRWRpdEZvcm0pO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGNvbnN0YW50cy5jb25maWdcclxuKTtcclxuY29uc3QgZGVsZXRlQ29uZmlybWF0aW9uID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcclxuICBjb25zdGFudHMuZGVsZXRlTW9kYWwsXHJcbiAgY29uc3RhbnRzLmNvbmZpZ1xyXG4pO1xyXG4vLyBIYW5kbGVyIEZ1bmN0aW9uc1xyXG5jb25zdCBoYW5kbGVFZGl0Rm9ybU9wZW4gPSAoKSA9PiB7XHJcbiAgZWRpdFByb2ZpbGVGb3JtLnNldElucHV0VmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZWRpdC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQcm9maWxlRm9ybS5vcGVuKCk7XHJcbn07XHJcbmNvbnN0IGhhbmRsZU5ld0NhcmRGb3JtT3BlbiA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcIm5ldy1jYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgbmV3Q2FyZEZvcm0ub3BlbigpO1xyXG59O1xyXG5jb25zdCBoYW5kbGVBdmF0YXJFZGl0T3BlbiA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1lZGl0LWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyRWRpdEZvcm0ub3BlbigpO1xyXG59O1xyXG4vLyBDbGljayBIYW5kbGVyc1xyXG5jb25zdGFudHMucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRGb3JtT3Blbik7XHJcbmNvbnN0YW50cy5uZXdDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVOZXdDYXJkRm9ybU9wZW4pO1xyXG5jb25zdGFudHMuYXZhdGFyRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQXZhdGFyRWRpdE9wZW4pO1xyXG4vLyBFdmVudCBMaXN0ZW5lcnNcclxucG9wdXBJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxubmV3Q2FyZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYXZhdGFyRWRpdEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZGVsZXRlQ29uZmlybWF0aW9uLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIFNldCBhbmQgZW5hYmxlIHZhbGlkYXRpb24gZm9yIGFsbCBmb3Jtc1xyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcildO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm0pID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybSk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKGNvbnN0YW50cy5jb25maWcpO1xyXG4vLyBTZXJ2ZXIgcmVxdWVzdHNcclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mb3JtYXRpb24oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VyUHJvZmlsZUltYWdlKHVzZXJEYXRhKTtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiIsImNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZSwgdXNlckRlc2NyaXB0aW9uLCB1c2VyUHJvZmlsZUltYWdlKSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IHVzZXJOYW1lO1xyXG4gICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uID0gdXNlckRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5fdXNlclByb2ZpbGVJbWFnZSA9IHVzZXJQcm9maWxlSW1hZ2U7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJEYXRhID0ge307XHJcblxyXG4gICAgdXNlckRhdGEubmFtZSA9IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50O1xyXG4gICAgdXNlckRhdGEuYWJvdXQgPSB0aGlzLl91c2VyRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgcmV0dXJuIHVzZXJEYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oaW5mbykge1xyXG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBpbmZvLm5hbWU7XHJcbiAgICB0aGlzLl91c2VyRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBpbmZvLmFib3V0O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlclByb2ZpbGVJbWFnZShkYXRhKSB7XHJcbiAgICB0aGlzLl91c2VyUHJvZmlsZUltYWdlLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgdGhpcy5fdXNlclByb2ZpbGVJbWFnZS5hbHQgPSB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrU2VydmVyUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZURhdGEodXNlckRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogY2FyZERhdGEudGl0bGUsXHJcbiAgICAgICAgbGluazogY2FyZERhdGEubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZUltYWdlKGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLmF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgY29udGFpbmVyKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwSW1hZ2UsIHBvcHVwSW1hZ2VUZXh0LCBwb3B1cCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cCB9KTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSBwb3B1cEltYWdlO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRleHQgPSBwb3B1cEltYWdlVGV4dDtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VUZXh0LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwLCBjb25maWcpIHtcclxuICAgIHN1cGVyKHsgcG9wdXAgfSk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc3VibWl0KGNhbGxCYWNrKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBjYWxsQmFjaztcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoQ29uZmlybWF0aW9uO1xyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJfcmVmIiwiX3JlZjIiLCJjYXJkVGVtcGxhdGUiLCJuYW1lIiwibGluayIsImlzTGlrZWQiLCJfaWQiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVDYXJkRGVsZXRlIiwiaGFuZGxlQ2FyZExpa2UiLCJ0aGlzIiwiX3RpdGxlIiwiX2xpbmsiLCJfY2FyZFRlbXBsYXRlIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVDYXJkRGVsZXRlIiwiX2hhbmRsZUNhcmRMaWtlIiwiX2dldFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwicXVlcnlTZWxlY3RvciIsInNldExpa2VTdGF0dXMiLCJfcmVuZGVyTGlrZSIsIl9saWtlQnRuIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwicmVtb3ZlQ2FyZCIsIl9jYXJkRWxlbWVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkSW1hZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ0biIsImdldFZpZXciLCJfY2FyZFRpdGxlIiwidGV4dENvbnRlbnQiLCJhbHQiLCJzcmMiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiX2hpZGVJbnB1dEVycm9yIiwiY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwicXVlcnlTZWxlY3RvckFsbCIsImVuYWJsZVZhbGlkYXRpb24iLCJwb3B1cCIsIl9wb3B1cCIsIm9wZW4iLCJkb2N1bWVudCIsIl9oYW5kbGVDbG9zZUJ5RXNjIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfcG9wdXBGb3JtIiwiZm9ybVNlbGVjdG9yIiwiX3N1Ym1pdEJ0biIsIl9zdWJtaXRCdG5UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJyZXNldEZvcm0iLCJyZXNldCIsInByZXZlbnREZWZhdWx0IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlSW1hZ2UiLCJjYXJkR2FsbGVyeSIsImNvbnRlbnQiLCJlZGl0TW9kYWwiLCJnZXRFbGVtZW50QnlJZCIsIm5ld0NhcmRNb2RhbCIsImF2YXRhck1vZGFsIiwiZGVsZXRlTW9kYWwiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsInByZXZpZXdJbWFnZSIsInByZXZpZXdJbWFnZVRleHQiLCJwcm9maWxlRWRpdEJ0biIsIm5ld0NhcmRCdG4iLCJhdmF0YXJFZGl0QnRuIiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsInBvcHVwSW5zdGFuY2UiLCJ0aGVuIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwidXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJEZXNjcmlwdGlvbiIsInVzZXJQcm9maWxlSW1hZ2UiLCJfdXNlck5hbWUiLCJfdXNlckRlc2NyaXB0aW9uIiwiX3VzZXJQcm9maWxlSW1hZ2UiLCJnZXRVc2VySW5mbyIsInVzZXJEYXRhIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsImluZm8iLCJzZXRVc2VyUHJvZmlsZUltYWdlIiwiYXZhdGFyIiwiY29uc3RhbnRzIiwiYXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9jaGVja1NlcnZlclJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvcm1hdGlvbiIsImZldGNoIiwiZ2V0SW5pdGlhbENhcmRzIiwiZWRpdFByb2ZpbGVEYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGROZXdDYXJkIiwiY2FyZERhdGEiLCJ0aXRsZSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlIiwiZGVsZXRlTGlrZSIsInVwZGF0ZVByb2ZpbGVJbWFnZSIsImF1dGhvcml6YXRpb24iLCJhZGRDYXJkIiwiY2FyZCIsImNhcmRFbGVtZW50IiwiQ2FyZCIsInBvcHVwSW1hZ2UiLCJkZWxldGVDb25maXJtYXRpb24iLCJzdWJtaXQiLCJjcmVhdGVDYXJkIiwiY2FyZFNlY3Rpb24iLCJzZXRJdGVtIiwicmVuZGVyZXIiLCJjb250YWluZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJwcmVwZW5kIiwicG9wdXBJbWFnZVRleHQiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cEltYWdlVGV4dCIsImVkaXRQcm9maWxlRm9ybSIsIlBvcHVwV2l0aEZvcm0iLCJlZGl0Rm9ybURhdGEiLCJuZXdDYXJkRm9ybSIsIm5ld0NhcmREYXRhIiwiYXZhdGFyRWRpdEZvcm0iLCJhdmF0YXJEYXRhIiwiY2FsbEJhY2siLCJfaGFuZGxlU3VibWl0IiwiaGFuZGxlRWRpdEZvcm1PcGVuIiwiZm9ybVZhbGlkYXRvcnMiLCJoYW5kbGVOZXdDYXJkRm9ybU9wZW4iLCJoYW5kbGVBdmF0YXJFZGl0T3BlbiIsImZvcm0iLCJ2YWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJhbGwiLCJpbml0aWFsQ2FyZHMiXSwic291cmNlUm9vdCI6IiJ9